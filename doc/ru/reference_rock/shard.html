





<!doctype html>
<html>
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Модуль shard</title>
    <link rel="icon" type="image/png" sizes="192x192"
          href="/theme/favicon/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32"
          href="/theme/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96"
          href="/theme/favicon/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16"
          href="/theme/favicon/favicon-16x16.png">
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:       '',
        VERSION:        '1.7.1',
        COLLAPSE_INDEX:  false,
        FILE_SUFFIX:    '.html',
        HAS_SOURCE:      true
      };
      
      
      var disqus_config = function () {
          // Replace PAGE_URL with your page's canonical URL variable
          // this.page.url = PAGE_URL;
          this.page.identifier = "reference_rock/shard";
          this.language = "ru"
      };
    </script>
    <script id="dsq-count-scr" src="https://tarantooldb.disqus.com/count.js" async/></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    <script type="text/javascript" src="../_static/headers.js"></script>
    <script type="text/javascript" src="../_static/jquery.sticky-kit.min.js"></script>
    <script type="text/javascript" src="/js/menu.js"></script>
    <script type="text/javascript" src="/js/mobile_menu.js"></script>
    <link rel="stylesheet" href="/theme/font-awesome.min.css">
    <link rel="stylesheet" href="/theme/design.css">
    <link rel="stylesheet" href="/theme/pygmentize.css">
    <link rel="stylesheet" href="../_static/sphinx_design.css">
     
    <!--[if lt IE 9]>
      <script src="/js/ie8.js"></script>
      <link rel="stylesheet" href="/theme/ie8.css" />
    <![endif]-->
    <script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-22120502-1', 'auto');
  ga('send', 'pageview');
</script>

<!-- Rating@Mail.ru counter -->
<script type="text/javascript">
  var _tmr = _tmr || [];
  _tmr.push({id: "2284916", type: "pageView", start: (new Date()).getTime()});
  (function (d, w) {
    var ts = d.createElement("script"); ts.type = "text/javascript"; ts.async = true;
    ts.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//top-fwz1.mail.ru/js/code.js";
    var f = function () {var s = d.getElementsByTagName("script")[0]; s.parentNode.insertBefore(ts, s);};
    if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); }
  })(document, window);
</script>
<noscript>
  <div style="position:absolute;left:-10000px;">
    <img src="//top-fwz1.mail.ru/counter?id=2284916;js=na" style="border:0;"
         height="1" width="1" alt="Рейтинг@Mail.ru" />
  </div>
</noscript>
<!-- //Rating@Mail.ru counter -->


  </head>
  
  <body class="p-cols_design b-doc-reference_rock/shard">
  
    <div class="b-wrapper">
      <!-- HEADER > -->
      
  <header class="b-header">
    <div class="b-header_menu_mobile">
      <div class="b-burger-button">
        <span></span>
      </div>
      <form role="search" class="b-header-search" action="../search.html" method="get">
        <input name="q" type="search">
      </form>
    </div>
    <div class="b-menu_mobile">
      <div class="b-menu_mobile__wrapper">
        <nav class="b-header_menu">
          
  <ul class="b-menu">
    
      <li class="b-menu-item">
        <a href="/" class="b-menu-item-url">Overview</a>
      </li>
    
      <li class="b-menu-item">
        <a href="http://try.tarantool.org" class="b-menu-item-url">Try</a>
      </li>
    
      <li class="b-menu-item">
        <a href="/doc/" class="b-menu-item-url">Documentation</a>
      </li>
    
      <li class="b-menu-item">
        <a href="/download.html" class="b-menu-item-url">Download</a>
      </li>
    
      <li class="b-menu-item">
        <a href="/careers.html" class="b-menu-item-url">Careers</a>
      </li>
    
      <li class="b-menu-item">
        <a href="http://rocks.tarantool.org" class="b-menu-item-url">Rocks</a>
      </li>
    
  </ul>

        </nav>
      </div>
      
    </div>
    <div class="b-header-wrapper">
      <nav class="b-header_menu">
        
  <ul class="b-menu">
    
      <li class="b-menu-item">
        <a href="/" class="b-menu-item-url">Overview</a>
      </li>
    
      <li class="b-menu-item">
        <a href="http://try.tarantool.org" class="b-menu-item-url">Try</a>
      </li>
    
      <li class="b-menu-item">
        <a href="/doc/" class="b-menu-item-url">Documentation</a>
      </li>
    
      <li class="b-menu-item">
        <a href="/download.html" class="b-menu-item-url">Download</a>
      </li>
    
      <li class="b-menu-item">
        <a href="/careers.html" class="b-menu-item-url">Careers</a>
      </li>
    
      <li class="b-menu-item">
        <a href="http://rocks.tarantool.org" class="b-menu-item-url">Rocks</a>
      </li>
    
  </ul>

      </nav>
    </div>
  </header>

      <!-- < HEADER -->

      <div class="b-content b-clearbox">
        
  <section class="b-lightgray_block b-documentation_top b-clearbox p-documentation_in">
    <div class="b-block-wrapper">
      <h2
      
        class="b-section-title b-ellipsis toggle-navigation"
      
        title="Модуль shard">
          Модуль shard
      </h2>
  <div class="b-doc-language_selector">
    <ul class="b-doc-language_selector-list">
    
      <li class="b-doc-language_selector-item">
      
        <a href="
  
    ../../reference_rock/shard.html
  
"
           class="b-doc-language_selector-item-url"> En </a>
      
      </li>
    
      <li class="b-doc-language_selector-item">
      
        <a href="
  
    ../ru/reference_rock/shard.html
  
"
           class="b-doc-language_selector-item-url p-active"> Ru </a>
      
      </li>
    
    </ul>
  </div>
</div>
  </section>
  
    <div class="b-cols_content b-clearbox">
      <div class="b-cols_content_left">
        <div class="b-menu-toc">
          
<form id="searchbox" role="search" class="search b-search" action="../search.html" method="get">
  <input class="b-search-text" name="q" type="text"/ placeholder="Search the manual">
  <input class="b-search-but" type="submit" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>

<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Общие сведения</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../intro.html#an-application-server-together-with-a-database-manager">Сервер приложений + СУБД</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro.html#database-features">Возможности СУБД</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Вопросы и ответы</a></li>
<li class="toctree-l1"><a class="reference internal" href="../book/index.html">Руководство пользователя</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../book/intro.html">1. Предисловие</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../book/intro.html#how-to-read-the-documentation">1.1. Как пользоваться документацией</a></li>
<li class="toctree-l3"><a class="reference internal" href="../book/intro.html#getting-in-touch-with-the-tarantool-community">1.2. Как связаться с сообществом разработчиков Tarantool'а</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../book/user_guide_getting_started.html">2. Начало работы</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../book/user_guide_getting_started.html#downloading-and-installing-a-binary-package">2.1. Скачивание и установка бинарного пакета</a></li>
<li class="toctree-l3"><a class="reference internal" href="../book/user_guide_getting_started.html#starting-tarantool-and-making-your-first-database">2.2. Первичный запуск Tarantool'а и создание базы данных</a></li>
<li class="toctree-l3"><a class="reference internal" href="../book/user_guide_getting_started.html#connecting-remotely">2.3. Установка удаленного соединения</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../book/box/index.html">3. Функционал СУБД</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../book/box/index.html#document-data-model">3.1. Модель данных</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../book/box/index.html#space">3.1.1. Пространство</a></li>
<li class="toctree-l4"><a class="reference internal" href="../book/box/index.html#tuple-set">3.1.2. Tuple set</a></li>
<li class="toctree-l4"><a class="reference internal" href="../book/box/index.html#index">3.1.3. Индекс</a></li>
<li class="toctree-l4"><a class="reference internal" href="../book/box/index.html#data-types">3.1.4. Типы данных</a></li>
<li class="toctree-l4"><a class="reference internal" href="../book/box/index.html#operations">3.1.5. Операции</a></li>
<li class="toctree-l4"><a class="reference internal" href="../book/box/index.html#saving-to-disk">3.1.6. Saving to disk</a></li>
<li class="toctree-l4"><a class="reference internal" href="../book/box/index.html#data-manipulation">3.1.7. Манипулирование данными</a></li>
<li class="toctree-l4"><a class="reference internal" href="../book/box/index.html#index-operations">3.1.8. Операции с индексами</a></li>
<li class="toctree-l4"><a class="reference internal" href="../book/box/index.html#the-box-library">3.1.9. Библиотека &quot;box&quot;</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../book/box/index.html#submodules-of-the-box-library">3.2. Вложенные модули из библиотеки &quot;box&quot;</a></li>
<li class="toctree-l3"><a class="reference internal" href="../book/box/index.html#the-two-storage-engines-memtx-and-vinyl">3.3. Два движка базы данных: memtx и vinyl</a></li>
<li class="toctree-l3"><a class="reference internal" href="../book/box/index.html#library-reference">3.4. Library reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../book/box/box_schema.html">3.4.1. Вложенный модуль <cite>box.schema</cite></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../book/box/box_schema.html#example">3.4.1.1. Пример</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../book/box/box_space.html">3.4.2. Вложенный модуль <cite>box.space</cite></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../book/box/box_space.html#example-use-box-space-functions-to-read-space-tuples">3.4.2.1. Example: use box.space functions to read _space tuples</a></li>
<li class="toctree-l5"><a class="reference internal" href="../book/box/box_space.html#example-use-box-space-functions-to-organize-a-space-tuple">3.4.2.2. Example: use box.space functions to organize a _space tuple</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../book/box/box_index.html">3.4.3. Вложенный модуль <cite>box.index</cite></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../book/box/box_index.html#example-showing-use-of-the-box-functions">3.4.3.1. Example showing use of the box functions</a></li>
<li class="toctree-l5"><a class="reference internal" href="../book/box/box_index.html#example-showing-a-user-defined-iterator">3.4.3.2. Example showing a user-defined iterator</a></li>
<li class="toctree-l5"><a class="reference internal" href="../book/box/box_index.html#submodule-box-index-with-index-type-rtree-for-spatial-searches">3.4.3.3. Submodule <cite>box.index</cite> with index type = RTREE for spatial searches</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../book/box/box_session.html">3.4.4. Вложенный модуль <cite>box.session</cite></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../book/box/box_session.html#example">3.4.4.1. Пример</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../book/box/box_tuple.html">3.4.5. Вложенный модуль <cite>box.tuple</cite></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../book/box/box_tuple.html#example">3.4.5.1. Пример</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../book/box/box_introspection.html">3.4.6. Просмотр состояния сервера</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../book/box/box_introspection.html#lua-module.box.cfg">3.4.6.1. Submodule <cite>box.cfg</cite></a></li>
<li class="toctree-l5"><a class="reference internal" href="../book/box/box_introspection.html#lua-module.box.info">3.4.6.2. Submodule <cite>box.info</cite></a></li>
<li class="toctree-l5"><a class="reference internal" href="../book/box/box_introspection.html#lua-module.box.slab">3.4.6.3. Submodule <cite>box.slab</cite></a></li>
<li class="toctree-l5"><a class="reference internal" href="../book/box/box_introspection.html#submodule-box-stat">3.4.6.4. Submodule <cite>box.stat</cite></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../book/box/admin.html">3.4.7. Служебные запросы</a></li>
<li class="toctree-l4"><a class="reference internal" href="../book/box/atomic.html">3.4.8. Атомарные операции</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../book/box/atomic.html#cooperative-multitasking-environment">3.4.8.1. Среда взаимной многозадачности</a></li>
<li class="toctree-l5"><a class="reference internal" href="../book/box/atomic.html#example">3.4.8.2. Пример</a></li>
<li class="toctree-l5"><a class="reference internal" href="../book/box/atomic.html#the-implicit-yield-rules">3.4.8.3. Правила неявной передачи управления</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../book/box/authentication.html">3.4.9. Ограничение доступа</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../book/box/authentication.html#passwords">3.4.9.1. Passwords</a></li>
<li class="toctree-l5"><a class="reference internal" href="../book/box/authentication.html#users-and-the-user-space">3.4.9.2. Users and the _user space</a></li>
<li class="toctree-l5"><a class="reference internal" href="../book/box/authentication.html#privileges-and-the-priv-space">3.4.9.3. Privileges and the _priv space</a></li>
<li class="toctree-l5"><a class="reference internal" href="../book/box/authentication.html#functions-and-the-func-space">3.4.9.4. Functions and the _func space</a></li>
<li class="toctree-l5"><a class="reference internal" href="../book/box/authentication.html#box-session-and-security">3.4.9.5. <code class="docutils literal"><span class="pre">box.session</span></code> and security</a></li>
<li class="toctree-l5"><a class="reference internal" href="../book/box/authentication.html#roles">3.4.9.6. Roles</a></li>
<li class="toctree-l5"><a class="reference internal" href="../book/box/authentication.html#example-showing-a-role-within-a-role">3.4.9.7. Example showing a role within a role</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../book/box/triggers.html">3.4.10. Триггеры</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../book/box/triggers.html#connection-triggers">3.4.10.1. Connection triggers</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../book/box/triggers.html#example">3.4.10.1.1. Пример</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../book/box/triggers.html#authentication-triggers">3.4.10.2. Authentication triggers</a></li>
<li class="toctree-l5"><a class="reference internal" href="../book/box/triggers.html#lua-module.box.space">3.4.10.3. Replace triggers</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../book/box/triggers.html#id1">3.4.10.3.1. Пример</a></li>
<li class="toctree-l6"><a class="reference internal" href="../book/box/triggers.html#another-example">3.4.10.3.2. Another Example</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../book/box/triggers.html#getting-a-list-of-triggers">3.4.10.4. Getting a list of triggers</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../book/box/limitations.html">3.4.11. Ограничения</a></li>
<li class="toctree-l4"><a class="reference internal" href="../book/box/vinyl_diff.html">3.4.12. Различия между движками memtx и vinyl</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../book/replication/index.html">4. Репликация</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../book/replication/index.html#replication-architecture">4.1. Архитектура механизма репликации</a></li>
<li class="toctree-l3"><a class="reference internal" href="../book/replication/index.html#setting-up-the-master">4.2. Настройка главного сервера</a></li>
<li class="toctree-l3"><a class="reference internal" href="../book/replication/index.html#setting-up-a-replica">4.3. Настройка сервера-реплики</a></li>
<li class="toctree-l3"><a class="reference internal" href="../book/replication/index.html#recovering-from-a-degraded-state">4.4. Восстановление после сбоя</a></li>
<li class="toctree-l3"><a class="reference internal" href="../book/replication/index.html#instructions-for-quick-startup-of-a-new-two-server-simple-cluster">4.5. Инструкции по быстрому запуску простого кластера из двух серверов с нуля</a></li>
<li class="toctree-l3"><a class="reference internal" href="../book/replication/index.html#monitoring-a-replica-s-actions">4.6. Мониторинг действий реплики</a></li>
<li class="toctree-l3"><a class="reference internal" href="../book/replication/index.html#preventing-duplicate-actions">4.7. Предотвращение дублирующихся действий</a></li>
<li class="toctree-l3"><a class="reference internal" href="../book/replication/index.html#master-master-replication">4.8. Репликация по схеме master-master</a></li>
<li class="toctree-l3"><a class="reference internal" href="../book/replication/index.html#all-the-what-if-questions">4.9. Ответы на вопросы &quot;Что если?&quot;</a></li>
<li class="toctree-l3"><a class="reference internal" href="../book/replication/index.html#hands-on-replication-tutorial">4.10. Практическое руководство по репликации</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../book/configuration/index.html">5. Справочник по конфигурированию</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../book/configuration/index.html#command-options">5.1. Опции командной строки</a></li>
<li class="toctree-l3"><a class="reference internal" href="../book/configuration/index.html#uri">5.2. Универсальный код ресурса (URI)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../book/configuration/index.html#initialization-file">5.3. Файл инициализации</a></li>
<li class="toctree-l3"><a class="reference internal" href="../book/configuration/index.html#configuration-parameters">5.4. Параметры конфигурации</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../book/configuration/index.html#basic-parameters">5.4.1. Основные параметры</a></li>
<li class="toctree-l4"><a class="reference internal" href="../book/configuration/index.html#configuring-the-storage">5.4.2. Настройка хранилища данных</a></li>
<li class="toctree-l4"><a class="reference internal" href="../book/configuration/index.html#snapshot-daemon">5.4.3. Фоновая программа для работы со снимками</a></li>
<li class="toctree-l4"><a class="reference internal" href="../book/configuration/index.html#binary-logging-and-snapshots">5.4.4. Журналирование и снимки в бинарном формате</a></li>
<li class="toctree-l4"><a class="reference internal" href="../book/configuration/index.html#replication">5.4.5. Репликация</a></li>
<li class="toctree-l4"><a class="reference internal" href="../book/configuration/index.html#networking">5.4.6. Работа с сетевыми соединениями</a></li>
<li class="toctree-l4"><a class="reference internal" href="../book/configuration/index.html#logging">5.4.7. Запись в журнал</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../book/configuration/index.html#local-hot-standby">5.5. Режим горячего резервирования</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../book/administration.html">6. Администрирование серверной части</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../book/administration.html#server-signal-handling">6.1. Обработка сигналов от сервера</a></li>
<li class="toctree-l3"><a class="reference internal" href="../book/administration.html#process-title">6.2. Название процесса</a></li>
<li class="toctree-l3"><a class="reference internal" href="../book/administration.html#using-tarantool-as-a-client">6.3. Использование tarantool в качестве клиента</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../book/administration.html#conventions-used-in-this-section">6.3.1. Условные обозначения, используемые в этом разделе</a></li>
<li class="toctree-l4"><a class="reference internal" href="../book/administration.html#options-when-starting-client-from-the-command-line">6.3.2. Параметры запуска клиента из командной строки</a></li>
<li class="toctree-l4"><a class="reference internal" href="../book/administration.html#tokens-requests-and-special-key-combinations">6.3.3. Токены, запросы и специальные комбинации клавиш</a></li>
<li class="toctree-l4"><a class="reference internal" href="../book/administration.html#requests">6.3.4. Запросы</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../book/administration.html#utility-tarantoolctl">6.4. Утилита tarantoolctl</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../book/administration.html#configuration-for-tarantoolctl">6.4.1. Конфигурирование tarantoolctl</a></li>
<li class="toctree-l4"><a class="reference internal" href="../book/administration.html#commands-for-tarantoolctl">6.4.2. Команды для tarantoolctl</a></li>
<li class="toctree-l4"><a class="reference internal" href="../book/administration.html#typical-code-snippets-for-tarantoolctl">6.4.3. Примеры кода для tarantoolctl</a></li>
<li class="toctree-l4"><a class="reference internal" href="../book/administration.html#a-detailed-example-for-tarantoolctl">6.4.4. Подробный пример для tarantoolctl</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../book/administration.html#utility-tarantoolctl-connect">6.5. Утилита tarantoolctl connect</a></li>
<li class="toctree-l3"><a class="reference internal" href="../book/administration.html#admin-ports">6.6. Порты для администрирования</a></li>
<li class="toctree-l3"><a class="reference internal" href="../book/administration.html#system-specific-administration-notes">6.7. Заметки по администрированию для разных платформ</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../book/administration.html#debian-gnu-linux-and-ubuntu">6.7.1. Debian GNU/Linux and Ubuntu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../book/administration.html#fedora-rhel-centos">6.7.2. Fedora, RHEL, CentOS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../book/administration.html#freebsd">6.7.3. FreeBSD</a></li>
<li class="toctree-l4"><a class="reference internal" href="../book/administration.html#mac-os-x">6.7.4. Mac OS X</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../book/administration.html#notes-for-systemd-users">6.8. Заметки для пользователей systemd</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../book/administration.html#instance-management">6.8.1. Управление экземплярами</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../book/administration.html#creating-instances">6.8.1.1. Создание экземпляров</a></li>
<li class="toctree-l5"><a class="reference internal" href="../book/administration.html#starting-instances">6.8.1.2. Запуск экземпляров</a></li>
<li class="toctree-l5"><a class="reference internal" href="../book/administration.html#monitoring-instances">6.8.1.3. Мониторинг экземпляров</a></li>
<li class="toctree-l5"><a class="reference internal" href="../book/administration.html#attaching-to-instances">6.8.1.4. Подсоединение к экземплярам</a></li>
<li class="toctree-l5"><a class="reference internal" href="../book/administration.html#checking-logs">6.8.1.5. Проверка журнала</a></li>
<li class="toctree-l5"><a class="reference internal" href="../book/administration.html#stopping-instances">6.8.1.6. Остановка экземпляров</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../book/administration.html#daemon-supervision">6.8.2. Контроль за фоновыми программами</a></li>
<li class="toctree-l4"><a class="reference internal" href="../book/administration.html#customizing-the-service-file">6.8.3. Правка настроек сервисного файла</a></li>
<li class="toctree-l4"><a class="reference internal" href="../book/administration.html#debugging">6.8.4. Отладка</a></li>
<li class="toctree-l4"><a class="reference internal" href="../book/administration.html#precautions">6.8.5. Особые указания</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../book/administration.html#updating-tarantool-in-production">6.9. Обновление Tarantool'а в условиях эксплуатации</a></li>
<li class="toctree-l3"><a class="reference internal" href="../book/administration.html#backups">6.10. Резервное копирование</a></li>
<li class="toctree-l3"><a class="reference internal" href="../book/administration.html#upgrades">6.11. Обновление Tarantool'а</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../book/connectors/index.html">7. Коннекторы</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../book/connectors/index.html#protocol">7.1. Протокол</a></li>
<li class="toctree-l3"><a class="reference internal" href="../book/connectors/index.html#packet-example">7.2. Пример пакета данных</a></li>
<li class="toctree-l3"><a class="reference internal" href="../book/connectors/index.html#setting-up-the-server-for-connector-examples">7.3. Настройка окружения для примеров работы с коннекторами</a></li>
<li class="toctree-l3"><a class="reference internal" href="../book/connectors/index.html#java">7.4. Java</a></li>
<li class="toctree-l3"><a class="reference internal" href="../book/connectors/index.html#go">7.5. Go</a></li>
<li class="toctree-l3"><a class="reference internal" href="../book/connectors/index.html#r">7.6. R</a></li>
<li class="toctree-l3"><a class="reference internal" href="../book/connectors/index.html#perl">7.7. Perl</a></li>
<li class="toctree-l3"><a class="reference internal" href="../book/connectors/index.html#php">7.8. PHP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../book/connectors/index.html#python">7.9. Python</a></li>
<li class="toctree-l3"><a class="reference internal" href="../book/connectors/index.html#c">7.10. C</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../book/connectors/index.html#example-1">7.10.1. Пример 1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../book/connectors/index.html#example-2">7.10.2. Пример 2</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../book/connectors/index.html#interpreting-function-return-values">7.11. Интерпретация возвращаемых значений</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../book/modules.html">8. Модули</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../book/modules.html#installing-an-existing-module">8.1. Установка существующего модуля</a></li>
<li class="toctree-l3"><a class="reference internal" href="../book/modules.html#creating-a-new-lua-module-locally">8.2. Создание нового модуля на языке Lua</a></li>
<li class="toctree-l3"><a class="reference internal" href="../book/modules.html#creating-a-new-c-c-module-locally">8.3. Создание нового модуля на языке C/C++</a></li>
<li class="toctree-l3"><a class="reference internal" href="../book/modules.html#creating-a-mixed-lua-c-module-locally">8.4. Создание нового модуля на смеси языков Lua/C</a></li>
<li class="toctree-l3"><a class="reference internal" href="../book/modules.html#tips-for-special-situations">8.5. Примечания для особых случаев</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../book/app/a_errcodes.html">9. Приложение A. Коды ошибок</a></li>
<li class="toctree-l2"><a class="reference internal" href="../book/app/b_internals.html">10. Приложение B. Детали реализации</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../book/app/b_internals.html#data-persistence-and-the-wal-file-format">10.1. Сохранность данных и формат WAL-файла</a></li>
<li class="toctree-l3"><a class="reference internal" href="../book/app/b_internals.html#the-snapshot-file-format">10.2. Формат статического файла-снимка</a></li>
<li class="toctree-l3"><a class="reference internal" href="../book/app/b_internals.html#the-recovery-process">10.3. Процесс восстановления</a></li>
<li class="toctree-l3"><a class="reference internal" href="../book/app/b_internals.html#server-startup-with-replication">10.4. Запуск сервера с репликацией</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../book/app/c_lua_tutorial.html">11. Приложение C. Учебные примеры на языке Lua</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../book/app/c_lua_tutorial.html#insert-one-million-tuples-with-a-lua-stored-procedure">11.1. Вставка 1 млн кортежей с помощью хранимой процедуры на языке Lua</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../book/app/c_lua_tutorial.html#configure">11.1.1. Configure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../book/app/c_lua_tutorial.html#delimiter">11.1.2. Delimiter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../book/app/c_lua_tutorial.html#create-a-function-that-returns-a-string">11.1.3. Create a function that returns a string</a></li>
<li class="toctree-l4"><a class="reference internal" href="../book/app/c_lua_tutorial.html#create-a-function-that-calls-another-function-and-sets-a-variable">11.1.4. Create a function that calls another function and sets a variable</a></li>
<li class="toctree-l4"><a class="reference internal" href="../book/app/c_lua_tutorial.html#modify-the-function-so-it-returns-a-one-letter-random-string">11.1.5. Modify the function so it returns a one-letter random string</a></li>
<li class="toctree-l4"><a class="reference internal" href="../book/app/c_lua_tutorial.html#modify-the-function-so-it-returns-a-ten-letter-random-string">11.1.6. Modify the function so it returns a ten-letter random string</a></li>
<li class="toctree-l4"><a class="reference internal" href="../book/app/c_lua_tutorial.html#make-a-tuple-out-of-a-number-and-a-string">11.1.7. Make a tuple out of a number and a string</a></li>
<li class="toctree-l4"><a class="reference internal" href="../book/app/c_lua_tutorial.html#modify-main-function-to-insert-a-tuple-into-the-database">11.1.8. Modify main_function to insert a tuple into the database</a></li>
<li class="toctree-l4"><a class="reference internal" href="../book/app/c_lua_tutorial.html#modify-main-function-to-insert-a-million-tuples-into-the-database">11.1.9. Modify main_function to insert a million tuples into the database</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../book/app/c_lua_tutorial.html#sum-a-json-field-for-all-tuples">11.2. Подсчет суммы по JSON-полям во всех кортежах</a></li>
<li class="toctree-l3"><a class="reference internal" href="../book/app/c_lua_tutorial.html#indexed-pattern-search">11.3. Индексированный поиск по шаблонам</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../book/app/d_vinyl/index.html">12. Приложение D. Vinyl</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../book/app/d_vinyl/index.html#introduction">12.1. Введение</a></li>
<li class="toctree-l3"><a class="reference internal" href="../book/app/d_vinyl/index.html#under-the-hood">12.2. А что там &quot;под капотом&quot;?</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../book/app/d_vinyl/index.html#inserting-the-first-200-000-keys">12.2.1. Inserting the first 200.000 keys</a></li>
<li class="toctree-l4"><a class="reference internal" href="../book/app/d_vinyl/index.html#inserting-the-next-300-000-keys">12.2.2. Inserting the next 300.000 keys</a></li>
<li class="toctree-l4"><a class="reference internal" href="../book/app/d_vinyl/index.html#inserting-the-next-200-000-keys">12.2.3. Inserting the next 200.000 keys</a></li>
<li class="toctree-l4"><a class="reference internal" href="../book/app/d_vinyl/index.html#inserting-the-last-300-000-keys">12.2.4. Inserting the last 300.000 keys</a></li>
<li class="toctree-l4"><a class="reference internal" href="../book/app/d_vinyl/index.html#reading-million-keys">12.2.5. Reading million keys</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../book/app/e_cookbook.html">13. Приложение E. Готовые рецепты</a></li>
<li class="toctree-l2"><a class="reference internal" href="../book/app/f_c_tutorial.html">14. Приложение F. Учебные примеры на языке C</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../book/app/f_c_tutorial.html#c-stored-procedures">14.1. Работа с хранимыми процедурами на языке C</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../book/app/g_changes.html">15. Приложение G. Версионные изменения</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../book/app/g_changes.html#changes-in-tarantool-version-1-7">15.1. Изменения в версии Tarantool 1.7</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../reference_lua/index.html">Справочник по Lua API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../reference_lua/box.html">Module <cite>box</cite></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../book/box/box_schema.html">3.4.1. Вложенный модуль <cite>box.schema</cite></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../book/box/box_schema.html#example">3.4.1.1. Пример</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../book/box/box_space.html">3.4.2. Вложенный модуль <cite>box.space</cite></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../book/box/box_space.html#example-use-box-space-functions-to-read-space-tuples">3.4.2.1. Example: use box.space functions to read _space tuples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../book/box/box_space.html#example-use-box-space-functions-to-organize-a-space-tuple">3.4.2.2. Example: use box.space functions to organize a _space tuple</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../book/box/box_index.html">3.4.3. Вложенный модуль <cite>box.index</cite></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../book/box/box_index.html#example-showing-use-of-the-box-functions">3.4.3.1. Example showing use of the box functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../book/box/box_index.html#example-showing-a-user-defined-iterator">3.4.3.2. Example showing a user-defined iterator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../book/box/box_index.html#submodule-box-index-with-index-type-rtree-for-spatial-searches">3.4.3.3. Submodule <cite>box.index</cite> with index type = RTREE for spatial searches</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../book/box/box_session.html">3.4.4. Вложенный модуль <cite>box.session</cite></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../book/box/box_session.html#example">3.4.4.1. Пример</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../book/box/box_tuple.html">3.4.5. Вложенный модуль <cite>box.tuple</cite></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../book/box/box_tuple.html#example">3.4.5.1. Пример</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../book/box/box_introspection.html">3.4.6. Просмотр состояния сервера</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../book/box/box_introspection.html#lua-module.box.cfg">3.4.6.1. Submodule <cite>box.cfg</cite></a></li>
<li class="toctree-l4"><a class="reference internal" href="../book/box/box_introspection.html#lua-module.box.info">3.4.6.2. Submodule <cite>box.info</cite></a></li>
<li class="toctree-l4"><a class="reference internal" href="../book/box/box_introspection.html#lua-module.box.slab">3.4.6.3. Submodule <cite>box.slab</cite></a></li>
<li class="toctree-l4"><a class="reference internal" href="../book/box/box_introspection.html#submodule-box-stat">3.4.6.4. Submodule <cite>box.stat</cite></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../book/box/triggers.html">3.4.10. Триггеры</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../book/box/triggers.html#connection-triggers">3.4.10.1. Connection triggers</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../book/box/triggers.html#example">3.4.10.1.1. Пример</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../book/box/triggers.html#authentication-triggers">3.4.10.2. Authentication triggers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../book/box/triggers.html#lua-module.box.space">3.4.10.3. Replace triggers</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../book/box/triggers.html#id1">3.4.10.3.1. Пример</a></li>
<li class="toctree-l5"><a class="reference internal" href="../book/box/triggers.html#another-example">3.4.10.3.2. Another Example</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../book/box/triggers.html#getting-a-list-of-triggers">3.4.10.4. Getting a list of triggers</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference_lua/clock.html">Модуль <cite>clock</cite></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference_lua/console.html">Модуль <cite>console</cite></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference_lua/crypto.html">Модуль <cite>crypto</cite></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference_lua/crypto.html#incremental-methods-in-the-crypto-module">Incremental methods in the crypto module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference_lua/crypto.html#getting-the-same-results-from-digest-and-crypto-modules">Getting the same results from digest and crypto modules</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference_lua/csv.html">Module <cite>csv</cite></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference_lua/digest.html">Модуль <cite>digest</cite></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference_lua/digest.html#incremental-methods-in-the-digest-module">Incremental methods in the digest module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference_lua/digest.html#example">Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference_lua/box_error.html">Вложенный модуль <cite>box.error</cite></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference_lua/fiber.html">Модуль <cite>fiber</cite></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference_lua/fiber.html#example-of-fiber-use">Example Of Fiber Use</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference_lua/fiber_ipc.html">Модуль <cite>fiber-ipc</cite></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference_lua/fiber_ipc.html#example">Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference_lua/fio.html">Module <cite>fio</cite></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference_lua/fio.html#common-pathname-manipulations">Common pathname manipulations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference_lua/fio.html#common-file-manipulations">Common file manipulations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference_lua/fun.html">Module <cite>fun</cite></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference_lua/jit.html">Module <cite>jit</cite></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference_lua/json.html">Module <cite>json</cite></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference_lua/json.html#configuration-settings">Configuration settings</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference_lua/log.html">Module <cite>log</cite></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference_lua/log.html#example">Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference_lua/msgpack.html">Модуль <cite>msgpack</cite></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference_lua/msgpack.html#example">Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference_lua/net_box.html">Модуль <cite>net.box</cite></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference_lua/net_box.html#example-showing-use-of-most-of-the-net-box-methods">Example showing use of most of the net.box methods</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference_lua/box_once.html">Функция <cite>box.once</cite></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference_lua/os.html">Module <cite>os</cite></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference_lua/pickle.html">Модуль <cite>pickle</cite></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference_lua/socket.html">Модуль <cite>socket</cite></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference_lua/socket.html#example">Example</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference_lua/socket.html#use-of-a-tcp-socket-over-the-internet">Use of a TCP socket over the Internet</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference_lua/socket.html#use-of-a-udp-socket-on-localhost">Use of a UDP socket on localhost</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference_lua/socket.html#use-tcp-server-to-accept-file-contents-sent-with-socat">Use tcp_server to accept file contents sent with socat</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference_lua/strict.html">Модуль <cite>strict</cite></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference_lua/tap.html">Module <cite>tap</cite></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference_lua/tap.html#example">Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference_lua/tarantool.html">Модуль <cite>tarantool</cite></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference_lua/uuid.html">Module <cite>uuid</cite></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference_lua/uuid.html#example">Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference_lua/yaml.html">Module <cite>yaml</cite></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference_lua/yaml.html#example">Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference_lua/other.html">Разное</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Справочник по Lua rocks</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="dbms.html">Модули SQL СУБД</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dbms.html#mysql-example">MySQL Example</a><ul>
<li class="toctree-l4"><a class="reference internal" href="dbms.html#installation">Installation</a><ul>
<li class="toctree-l5"><a class="reference internal" href="dbms.html#with-luarocks">With LuaRocks</a></li>
<li class="toctree-l5"><a class="reference internal" href="dbms.html#with-github">With GitHub</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="dbms.html#connecting">Connecting</a></li>
<li class="toctree-l4"><a class="reference internal" href="dbms.html#how-to-ping">How to ping</a></li>
<li class="toctree-l4"><a class="reference internal" href="dbms.html#executing-a-statement">Executing a statement</a></li>
<li class="toctree-l4"><a class="reference internal" href="dbms.html#closing-connection">Closing connection</a></li>
<li class="toctree-l4"><a class="reference internal" href="dbms.html#example">Example</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dbms.html#postgresql-example">PostgreSQL Example</a><ul>
<li class="toctree-l4"><a class="reference internal" href="dbms.html#id1">Installation</a><ul>
<li class="toctree-l5"><a class="reference internal" href="dbms.html#id2">With LuaRocks</a></li>
<li class="toctree-l5"><a class="reference internal" href="dbms.html#id3">With GitHub</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="dbms.html#id4">Connecting</a></li>
<li class="toctree-l4"><a class="reference internal" href="dbms.html#id5">How to ping</a></li>
<li class="toctree-l4"><a class="reference internal" href="dbms.html#id6">Executing a statement</a></li>
<li class="toctree-l4"><a class="reference internal" href="dbms.html#id7">Closing connection</a></li>
<li class="toctree-l4"><a class="reference internal" href="dbms.html#id8">Example</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="expirationd.html">Модуль <cite>expirationd</cite></a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Модуль <cite>shard</cite></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#example-shard-init-syntax-for-one-shard">Example: shard.init syntax for one shard</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-shard-init-syntax-for-three-shards">Example: shard.init syntax for three shards</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-shard-minimal-configuration">Example: Shard, Minimal Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-shard-scaling-out">Example: Shard, Scaling Out</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tdb.html">Module <cite>tdb</cite></a><ul>
<li class="toctree-l3"><a class="reference internal" href="tdb.html#debugger-commands">Debugger Commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="tdb.html#example-session">Example Session</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../reference_capi/index.html">Справочник по C API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../reference_capi/box.html">Модуль <cite>box</cite></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference_capi/clock.html">Модуль <cite>clock</cite></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference_capi/coio.html">Модуль <cite>coio</cite></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference_capi/error.html">Модуль <cite>error</cite></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference_capi/fiber.html">Модуль <cite>fiber</cite></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference_capi/box_index.html">Модуль <cite>index</cite></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference_capi/latch.html">Модуль <cite>latch</cite></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference_capi/utils.html">Модуль <cite>lua/utils</cite></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference_capi/say.html">Модуль <cite>say</cite> (логирование)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference_capi/schema.html">Модуль <cite>schema</cite></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference_capi/trivia.html">Модуль <cite>trivia/config</cite></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference_capi/tuple.html">Модуль <cite>tuple</cite></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference_capi/txn.html">Модуль <cite>txn</cite></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../dev_guide/index.html">Руководство разработчика</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../dev_guide/intro.html">Состав документации</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dev_guide/building_from_source.html">Сборка из исходных файлов</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dev_guide/building_documentation.html">Сборка документации</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dev_guide/developer_guidelines.html">Соглашения по разработке</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../dev_guide/developer_guidelines.html#how-to-work-on-a-bug">How to work on a bug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../dev_guide/documentation_guidelines.html">Соглашения по документации</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../dev_guide/documentation_guidelines.html#markup-issues">Markup issues</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../dev_guide/documentation_guidelines.html#wrapping-text">Wrapping text</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dev_guide/documentation_guidelines.html#formatting-code-snippets">Formatting code snippets</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dev_guide/documentation_guidelines.html#using-separated-links">Using separated links</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dev_guide/documentation_guidelines.html#creating-labels-for-local-links">Creating labels for local links</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dev_guide/documentation_guidelines.html#making-comments">Making comments</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../dev_guide/documentation_guidelines.html#language-and-style-issues">Language and style issues</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../dev_guide/documentation_guidelines.html#us-vs-british-spelling">US vs British spelling</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../dev_guide/documentation_guidelines.html#examples-and-templates">Examples and templates</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../dev_guide/documentation_guidelines.html#module-and-function">Module and function</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dev_guide/documentation_guidelines.html#module-class-and-method">Module, class and method</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../dev_guide/box_protocol.html">Бинарный протокол в Tarantool'е</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../dev_guide/box_protocol.html#notion-in-diagrams">Обозначения на диаграммах</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev_guide/box_protocol.html#overview">Общие сведения о протоколе</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev_guide/box_protocol.html#greeting-packet">Пакет-приветствие</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev_guide/box_protocol.html#unified-packet-structure">Unified packet structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev_guide/box_protocol.html#authentication">Authentication</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev_guide/box_protocol.html#requests">Requests</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev_guide/box_protocol.html#response-packet-structure">Response packet structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev_guide/box_protocol.html#replication-packet-structure">Replication packet structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev_guide/box_protocol.html#xlog-snap">XLOG / SNAP</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../dev_guide/c_style_guide.html">Соглашения по разработке на языке C</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../dev_guide/c_style_guide.html#general-guidelines">General guidelines</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../dev_guide/c_style_guide.html#commenting-style">Commenting style</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dev_guide/c_style_guide.html#header-files">Header files</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dev_guide/c_style_guide.html#allocating-memory">Allocating memory</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dev_guide/c_style_guide.html#other">Other</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../dev_guide/c_style_guide.html#linux-kernel-coding-style">Linux kernel coding style</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../dev_guide/c_style_guide.html#chapter-1-indentation">Chapter 1: Indentation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dev_guide/c_style_guide.html#chapter-2-breaking-long-lines-and-strings">Chapter 2: Breaking long lines and strings</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dev_guide/c_style_guide.html#chapter-3-placing-braces-and-spaces">Chapter 3: Placing Braces and Spaces</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dev_guide/c_style_guide.html#chapter-3-1-spaces">Chapter 3.1:  Spaces</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dev_guide/c_style_guide.html#chapter-4-naming">Chapter 4: Naming</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dev_guide/c_style_guide.html#chapter-5-typedefs">Chapter 5: Typedefs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dev_guide/c_style_guide.html#chapter-6-functions">Chapter 6: Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dev_guide/c_style_guide.html#chapter-7-centralized-exiting-of-functions">Chapter 7: Centralized exiting of functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dev_guide/c_style_guide.html#chapter-8-commenting">Chapter 8: Commenting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dev_guide/c_style_guide.html#chapter-9-you-ve-made-a-mess-of-it">Chapter 9: You've made a mess of it</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dev_guide/c_style_guide.html#chapter-10-kconfig-configuration-files">Chapter 10: Kconfig configuration files</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dev_guide/c_style_guide.html#chapter-11-data-structures">Chapter 11: Data structures</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dev_guide/c_style_guide.html#chapter-12-macros-enums-and-rtl">Chapter 12: Macros, Enums and RTL</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dev_guide/c_style_guide.html#chapter-13-printing-kernel-messages">Chapter 13: Printing kernel messages</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dev_guide/c_style_guide.html#chapter-14-allocating-memory">Chapter 14: Allocating memory</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dev_guide/c_style_guide.html#chapter-15-the-inline-disease">Chapter 15: The inline disease</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dev_guide/c_style_guide.html#chapter-16-function-return-values-and-names">Chapter 16: Function return values and names</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dev_guide/c_style_guide.html#chapter-17-don-t-re-invent-the-kernel-macros">Chapter 17:  Don't re-invent the kernel macros</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dev_guide/c_style_guide.html#chapter-18-editor-modelines-and-other-cruft">Chapter 18:  Editor modelines and other cruft</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dev_guide/c_style_guide.html#appendix-i-references">Appendix I: References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../dev_guide/python_style_guide.html">Соглашения по разработке на языке Python</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../dev_guide/python_style_guide.html#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev_guide/python_style_guide.html#a-foolish-consistency-is-the-hobgoblin-of-little-minds">A Foolish Consistency is the Hobgoblin of Little Minds</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev_guide/python_style_guide.html#code-lay-out">Code lay-out</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../dev_guide/python_style_guide.html#indentation">Indentation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dev_guide/python_style_guide.html#tabs-or-spaces">Tabs or Spaces?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dev_guide/python_style_guide.html#maximum-line-length">Maximum Line Length</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dev_guide/python_style_guide.html#blank-lines">Blank Lines</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dev_guide/python_style_guide.html#encodings-pep-263">Encodings (PEP 263)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dev_guide/python_style_guide.html#imports">Imports</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../dev_guide/python_style_guide.html#whitespace-in-expressions-and-statements">Whitespace in Expressions and Statements</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../dev_guide/python_style_guide.html#pet-peeves">Pet Peeves</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dev_guide/python_style_guide.html#other-recommendations">Other Recommendations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../dev_guide/python_style_guide.html#comments">Comments</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../dev_guide/python_style_guide.html#block-comments">Block Comments</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dev_guide/python_style_guide.html#inline-comments">Inline Comments</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dev_guide/python_style_guide.html#documentation-strings">Documentation Strings</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../dev_guide/python_style_guide.html#version-bookkeeping">Version Bookkeeping</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev_guide/python_style_guide.html#naming-conventions">Naming Conventions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../dev_guide/python_style_guide.html#descriptive-naming-styles">Descriptive: Naming Styles</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dev_guide/python_style_guide.html#prescriptive-naming-conventions">Prescriptive: Naming Conventions</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../dev_guide/python_style_guide.html#names-to-avoid">Names to Avoid</a></li>
<li class="toctree-l5"><a class="reference internal" href="../dev_guide/python_style_guide.html#package-and-module-names">Package and Module Names</a></li>
<li class="toctree-l5"><a class="reference internal" href="../dev_guide/python_style_guide.html#class-names">Class Names</a></li>
<li class="toctree-l5"><a class="reference internal" href="../dev_guide/python_style_guide.html#exception-names">Exception Names</a></li>
<li class="toctree-l5"><a class="reference internal" href="../dev_guide/python_style_guide.html#global-variable-names">Global Variable Names</a></li>
<li class="toctree-l5"><a class="reference internal" href="../dev_guide/python_style_guide.html#function-names">Function Names</a></li>
<li class="toctree-l5"><a class="reference internal" href="../dev_guide/python_style_guide.html#function-and-method-arguments">Function and method arguments</a></li>
<li class="toctree-l5"><a class="reference internal" href="../dev_guide/python_style_guide.html#method-names-and-instance-variables">Method Names and Instance Variables</a></li>
<li class="toctree-l5"><a class="reference internal" href="../dev_guide/python_style_guide.html#constants">Constants</a></li>
<li class="toctree-l5"><a class="reference internal" href="../dev_guide/python_style_guide.html#designing-for-inheritance">Designing for inheritance</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../dev_guide/python_style_guide.html#references">References</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dev_guide/python_style_guide.html#copyright">Copyright</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../dev_guide/release_management.html">Работа с релизами</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../dev_guide/release_management.html#how-to-make-a-minor-release">How to make a minor release</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
      <div class="b-cols_content_right">
        <div class="b-cols_content_right-slot">
  <div class="b-page_header">
    <ul class="b-path-list">
      <li class="b-path-list-item">
        <a href="../index.html"
           class="b-path-list-item-url">
          Documentation
        </a>
      </li>
      
        <li class="b-path-list-item">
          <a href="index.html"
             class="b-path-list-item-url b-ellipsis">
            Справочник по Lua rocks
          </a>
        </li>
      
      
      <li class="b-path-list-item">
        <div title="Модуль <cite>shard</cite>" class="b-path_current b-ellipsis">
          Модуль <cite>shard</cite>
        </div>
      </li>
      
    </ul>
  </div>

  <div class="section" id="lua-module.shard">
<span id="module-shard"></span><span id="shard-module"></span><h1>Модуль <cite>shard</cite><a class="headerlink" href="#lua-module.shard" title="Ссылка на этот заголовок">¶</a></h1>
<p>With sharding, the tuples of a tuple set are distributed to multiple nodes,
with a Tarantool database server on each node. With this arrangement,
each server is handling only a subset of the total data,
so larger loads can be handled by simply adding more computers to a network.</p>
<p>The Tarantool shard module has facilities for creating shards,
as well as analogues for the data-manipulation functions of the box library
(select, insert, replace, update, delete).</p>
<p>First some terminology:</p>
<dl class="glossary docutils">
<dt id="term-consistent-hash"><strong>Consistent Hash</strong></dt>
<dd>The shard module distributes according to a hash algorithm, that is,
it applies a hash function to a tuple's primary-key value in order to
decide which shard the tuple belongs to. The hash function is <a class="reference external" href="https://en.wikipedia.org/wiki/Consistent_hashing">consistent</a>
so that changing the number of servers will not affect results for many
keys. The specific hash function that the shard module uses is
<a class="reference internal" href="../reference_lua/digest.html#digest-guava"><span class="std std-ref">digest.guava</span></a> in the <span class="ccodei">digest</span> module.</dd>
<dt id="term-queue"><strong>Queue</strong></dt>
<dd>A temporary list of recent update requests. Sometimes called &quot;batching&quot;.
Since updates to a sharded database can be slow, it may speed up
throughput to send requests to a queue rather than wait for the update
to finish on ever node. The shard module has functions for adding
requests to the queue, which it will process without further intervention.
Queuing is optional.</dd>
<dt id="term-redundancy"><strong>Redundancy</strong></dt>
<dd>The number of replicas in each shard.</dd>
<dt id="term-replica"><strong>Replica</strong></dt>
<dd>A complete copy of the data. The shard module handles both sharding
and replication. One shard can contain one or more replicas.
When a write occurs, the write is attempted on every replica in turn.
The shard module does not use the built-in replication feature.</dd>
<dt id="term-shard"><strong>Shard</strong></dt>
<dd>A subset of the tuples in the database partitioned according to the
value returned by the consistent hash function. Usually each shard
is on a separate node, or a separate set of nodes (for example if
redundancy = 3 then the shard will be on three nodes).</dd>
<dt id="term-zone"><strong>Zone</strong></dt>
<dd>A physical location where the nodes are closely connected, with
the same security and backup and access points. The simplest example
of a zone is a single computer with a single tarantool-server instance.
A shard's replicas should be in different zones.</dd>
</dl>
<p>The shard package is distributed separately from the main tarantool package.
To acquire it, do a separate install. For example on Ubuntu say:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>sudo apt-get install tarantool-shard tarantool-pool
</pre></div>
</div>
<p>Or, download from github tarantool/shard and compile as described in the README.
Then, before using the module, say <code class="docutils literal"><span class="pre">shard</span> <span class="pre">=</span> <span class="pre">require('shard')</span></code></p>
<p>The most important function is:</p>
<pre class="highlight literal-block">
shard.init(<em>shard-configuration</em>)
</pre>
<p>This must be called for every shard.
The shard-configuration is a table with these fields:</p>
<ul class="simple">
<li>servers (a list of URIs of nodes and the zones the nodes are in)</li>
<li>login (the user name which applies for accessing via the shard module)</li>
<li>password (the password for the login)</li>
<li>redundancy (a number, minimum 1)</li>
<li>binary (a port number that this host is listening on, on the current host)
(distinguishable from the 'listen' port specified by box.cfg)</li>
</ul>
<p>Possible Errors: Redundancy should not be greater than the number of servers;
the servers must be alive; two replicas of the same shard should not be in the
same zone.</p>
<div class="section" id="example-shard-init-syntax-for-one-shard">
<h2>Example: shard.init syntax for one shard<a class="headerlink" href="#example-shard-init-syntax-for-one-shard" title="Ссылка на этот заголовок">¶</a></h2>
<p>The number of replicas per shard (redundancy) is 3.
The number of servers is 3.
The shard module will conclude that there is only one shard.</p>
<div class="highlight-tarantoolsession"><div class="highlight"><pre><span></span><span class="gp">tarantool&gt; </span><span class="n">cfg</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">         &gt; </span>  <span class="n">servers</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">         &gt; </span>    <span class="p">{</span> <span class="n">uri</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">localhost:33131&#39;</span><span class="p">,</span> <span class="n">zone</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">1&#39;</span> <span class="p">},</span>
<span class="gp">         &gt; </span>    <span class="p">{</span> <span class="n">uri</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">localhost:33132&#39;</span><span class="p">,</span> <span class="n">zone</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">2&#39;</span> <span class="p">},</span>
<span class="gp">         &gt; </span>    <span class="p">{</span> <span class="n">uri</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">localhost:33133&#39;</span><span class="p">,</span> <span class="n">zone</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">3&#39;</span> <span class="p">}</span>
<span class="gp">         &gt; </span>  <span class="p">},</span>
<span class="gp">         &gt; </span>  <span class="n">login</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">tester&#39;</span><span class="p">,</span>
<span class="gp">         &gt; </span>  <span class="n">password</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">pass&#39;</span><span class="p">,</span>
<span class="gp">         &gt; </span>  <span class="n">redundancy</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">3&#39;</span><span class="p">,</span>
<span class="gp">         &gt; </span>  <span class="n">binary</span> <span class="o">=</span> <span class="mi">33131</span><span class="p">,</span>
<span class="gp">         &gt; </span><span class="p">}</span>
<span class="nn">---</span>
<span class="nn">...</span>
<span class="gp">tarantool&gt; </span><span class="n">shard</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span>
<span class="nn">---</span>
<span class="nn">...</span>
</pre></div>
</div>
</div>
<div class="section" id="example-shard-init-syntax-for-three-shards">
<h2>Example: shard.init syntax for three shards<a class="headerlink" href="#example-shard-init-syntax-for-three-shards" title="Ссылка на этот заголовок">¶</a></h2>
<p>This describes three shards. Each shard has two replicas. Since the number of
servers is 7, and the number of replicas per shard is 2, and dividing 7 / 2
leaves a remainder of 1, one of the servers will not be used. This is not
necessarily an error, because perhaps one of the servers in the list is not alive.</p>
<div class="highlight-tarantoolsession"><div class="highlight"><pre><span></span><span class="gp">tarantool&gt; </span><span class="n">cfg</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">         &gt; </span>  <span class="n">servers</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">         &gt; </span>    <span class="p">{</span> <span class="n">uri</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">host1:33131&#39;</span><span class="p">,</span> <span class="n">zone</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">1&#39;</span> <span class="p">},</span>
<span class="gp">         &gt; </span>    <span class="p">{</span> <span class="n">uri</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">host2:33131&#39;</span><span class="p">,</span> <span class="n">zone</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">2&#39;</span> <span class="p">},</span>
<span class="gp">         &gt; </span>    <span class="p">{</span> <span class="n">uri</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">host3:33131&#39;</span><span class="p">,</span> <span class="n">zone</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">3&#39;</span> <span class="p">},</span>
<span class="gp">         &gt; </span>    <span class="p">{</span> <span class="n">uri</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">host4:33131&#39;</span><span class="p">,</span> <span class="n">zone</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">4&#39;</span> <span class="p">},</span>
<span class="gp">         &gt; </span>    <span class="p">{</span> <span class="n">uri</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">host5:33131&#39;</span><span class="p">,</span> <span class="n">zone</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">5&#39;</span> <span class="p">},</span>
<span class="gp">         &gt; </span>    <span class="p">{</span> <span class="n">uri</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">host6:33131&#39;</span><span class="p">,</span> <span class="n">zone</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">6&#39;</span> <span class="p">},</span>
<span class="gp">         &gt; </span>    <span class="p">{</span> <span class="n">uri</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">host7:33131&#39;</span><span class="p">,</span> <span class="n">zone</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">7&#39;</span> <span class="p">}</span>
<span class="gp">         &gt; </span>  <span class="p">},</span>
<span class="gp">         &gt; </span>  <span class="n">login</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">tester&#39;</span><span class="p">,</span>
<span class="gp">         &gt; </span>  <span class="n">password</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">pass&#39;</span><span class="p">,</span>
<span class="gp">         &gt; </span>  <span class="n">redundancy</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">2&#39;</span><span class="p">,</span>
<span class="gp">         &gt; </span>  <span class="n">binary</span> <span class="o">=</span> <span class="mi">33131</span><span class="p">,</span>
<span class="gp">         &gt; </span><span class="p">}</span>
<span class="nn">---</span>
<span class="nn">...</span>
<span class="gp">tarantool&gt; </span><span class="n">shard</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span>
<span class="nn">---</span>
<span class="nn">...</span>
</pre></div>
</div>
<pre class="highlight literal-block">
shard[<em>space-name</em>].insert{...}
shard[<em>space-name</em>].replace{...}
shard[<em>space-name</em>].delete{...}
shard[<em>space-name</em>].select{...}
shard[<em>space-name</em>].update{...}
shard[<em>space-name</em>].auto_increment{...}
</pre>
<p>Every data-access function in the box module has an analogue in the shard
module, so (for example) to insert in table T in a sharded database one simply
says <code class="docutils literal"><span class="pre">shard.T:insert{...}</span></code> instead of <code class="docutils literal"><span class="pre">box.space.T:insert{...}</span></code>.
A <code class="docutils literal"><span class="pre">shard.T:select{}</span></code> request without a primary key will search all shards.</p>
<pre class="highlight literal-block">
shard[<em>space-name</em>].q_insert{...}
shard[<em>space-name</em>].q_replace{...}
shard[<em>space-name</em>].q_delete{...}
shard[<em>space-name</em>].q_select{...}
shard[<em>space-name</em>].q_update{...}
shard[<em>space-name</em>].q_auto_increment{...}
</pre>
<p>Every queued data-access function has an analogue in the shard module. The user
must add an operation_id. The details of queued data-access functions, and of
maintenance-related functions, are on <a class="reference external" href="https://github.com/tarantool/shard">the shard section of github</a>.</p>
</div>
<div class="section" id="example-shard-minimal-configuration">
<h2>Example: Shard, Minimal Configuration<a class="headerlink" href="#example-shard-minimal-configuration" title="Ссылка на этот заголовок">¶</a></h2>
<p>There is only one shard, and that shard contains only one replica. So this isn't
illustrating the features of either replication or sharding, it's only
illustrating what the syntax is, and what the messages look like, that anyone
could duplicate in a minute or two with the magic of cut-and-paste.</p>
<div class="highlight-tarantoolsession"><div class="highlight"><pre><span></span><span class="gp">$</span> mkdir ~/tarantool_sandbox_1
<span class="gp">$</span> <span class="nb">cd</span> ~/tarantool_sandbox_1
<span class="gp">$</span> rm -r *.snap
<span class="gp">$</span> rm -r *.xlog
<span class="gp">$</span> ~/tarantool-1.7/src/tarantool

<span class="gp">tarantool&gt; </span><span class="n">box</span><span class="p">.</span><span class="n">cfg</span><span class="p">{</span><span class="n">listen</span> <span class="o">=</span> <span class="mi">3301</span><span class="p">}</span>
<span class="gp">tarantool&gt; </span><span class="n">box</span><span class="p">.</span><span class="n">schema</span><span class="p">.</span><span class="n">space</span><span class="p">.</span><span class="n">create</span><span class="p">(</span><span class="s1">&#39;</span><span class="s">tester&#39;</span><span class="p">)</span>
<span class="gp">tarantool&gt; </span><span class="n">box</span><span class="p">.</span><span class="n">space</span><span class="p">.</span><span class="n">tester</span><span class="p">:</span><span class="n">create_index</span><span class="p">(</span><span class="s1">&#39;</span><span class="s">primary&#39;</span><span class="p">,</span> <span class="p">{})</span>
<span class="gp">tarantool&gt; </span><span class="n">box</span><span class="p">.</span><span class="n">schema</span><span class="p">.</span><span class="n">user</span><span class="p">.</span><span class="n">passwd</span><span class="p">(</span><span class="s1">&#39;</span><span class="s">admin&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="s">password&#39;</span><span class="p">)</span>
<span class="gp">tarantool&gt; </span><span class="n">cfg</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">         &gt; </span>  <span class="n">servers</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">         &gt; </span>      <span class="p">{</span> <span class="n">uri</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">localhost:3301&#39;</span><span class="p">,</span> <span class="n">zone</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">1&#39;</span> <span class="p">},</span>
<span class="gp">         &gt; </span>  <span class="p">},</span>
<span class="gp">         &gt; </span>  <span class="n">login</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">admin&#39;</span><span class="p">;</span>
<span class="gp">         &gt; </span>  <span class="n">password</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">password&#39;</span><span class="p">;</span>
<span class="gp">         &gt; </span>  <span class="n">redundancy</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="gp">         &gt; </span>  <span class="n">binary</span> <span class="o">=</span> <span class="mi">3301</span><span class="p">;</span>
<span class="gp">         &gt; </span><span class="p">}</span>
<span class="gp">tarantool&gt; </span><span class="n">shard</span> <span class="o">=</span> <span class="nb">require</span><span class="p">(</span><span class="s1">&#39;</span><span class="s">shard&#39;</span><span class="p">)</span>
<span class="gp">tarantool&gt; </span><span class="n">shard</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span>
<span class="gp">tarantool&gt; </span><span class="c1">-- Now put something in ...</span>
<span class="gp">tarantool&gt; </span><span class="n">shard</span><span class="p">.</span><span class="n">tester</span><span class="p">:</span><span class="n">insert</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;</span><span class="s">Tuple #1&#39;</span><span class="p">}</span>
</pre></div>
</div>
<p>If one cuts and pastes the above, then the result,
showing only the requests and responses for shard.init
and shard.tester, should look approximately like this:</p>
<div class="highlight-tarantoolsession"><div class="highlight"><pre><span></span><span class="gp">tarantool&gt; </span><span class="n">shard</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span>
<span class="go">2015-08-09 ... I&gt; Sharding initialization started...</span>
<span class="go">2015-08-09 ... I&gt; establishing connection to cluster servers...</span>
<span class="go">2015-08-09 ... I&gt;  - localhost:3301 - connecting...</span>
<span class="go">2015-08-09 ... I&gt;  - localhost:3301 - connected</span>
<span class="go">2015-08-09 ... I&gt; connected to all servers</span>
<span class="go">2015-08-09 ... I&gt; started</span>
<span class="go">2015-08-09 ... I&gt; redundancy = 1</span>
<span class="go">2015-08-09 ... I&gt; Zone len=1 THERE</span>
<span class="go">2015-08-09 ... I&gt; Adding localhost:3301 to shard 1</span>
<span class="go">2015-08-09 ... I&gt; Zone len=1 THERE</span>
<span class="go">2015-08-09 ... I&gt; shards = 1</span>
<span class="go">2015-08-09 ... I&gt; Done</span>
<span class="nn">---</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="nn">...</span>
<span class="gp">tarantool&gt; </span><span class="c1">-- Now put something in ...</span>
<span class="nn">---</span>
<span class="nn">...</span>
<span class="gp">tarantool&gt; </span><span class="n">shard</span><span class="p">.</span><span class="n">tester</span><span class="p">:</span><span class="n">insert</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;</span><span class="s">Tuple #1&#39;</span><span class="p">}</span>
<span class="nn">---</span>
<span class="p p-Indicator">-</span> <span class="p p-Indicator">-</span> <span class="p p-Indicator">[</span><span class="nv">1</span><span class="p p-Indicator">,</span> <span class="s">&#39;Tuple</span><span class="nv"> </span><span class="s">#1&#39;</span><span class="p p-Indicator">]</span>
<span class="nn">...</span>
</pre></div>
</div>
</div>
<div class="section" id="example-shard-scaling-out">
<h2>Example: Shard, Scaling Out<a class="headerlink" href="#example-shard-scaling-out" title="Ссылка на этот заголовок">¶</a></h2>
<p>There are two shards, and each shard contains one replica. This requires two
nodes. In real life the two nodes would be two computers, but for this
illustration the requirement is merely: start two shells, which we'll call
Terminal#1 and Terminal #2.</p>
<p>On Terminal #1, say:</p>
<div class="highlight-tarantoolsession"><div class="highlight"><pre><span></span><span class="gp">$</span> mkdir ~/tarantool_sandbox_1
<span class="gp">$</span> <span class="nb">cd</span> ~/tarantool_sandbox_1
<span class="gp">$</span> rm -r *.snap
<span class="gp">$</span> rm -r *.xlog
<span class="gp">$</span> ~/tarantool-1.7/src/tarantool

<span class="gp">tarantool&gt; </span><span class="n">box</span><span class="p">.</span><span class="n">cfg</span><span class="p">{</span><span class="n">listen</span> <span class="o">=</span> <span class="mi">3301</span><span class="p">}</span>
<span class="gp">tarantool&gt; </span><span class="n">box</span><span class="p">.</span><span class="n">schema</span><span class="p">.</span><span class="n">space</span><span class="p">.</span><span class="n">create</span><span class="p">(</span><span class="s1">&#39;</span><span class="s">tester&#39;</span><span class="p">)</span>
<span class="gp">tarantool&gt; </span><span class="n">box</span><span class="p">.</span><span class="n">space</span><span class="p">.</span><span class="n">tester</span><span class="p">:</span><span class="n">create_index</span><span class="p">(</span><span class="s1">&#39;</span><span class="s">primary&#39;</span><span class="p">,</span> <span class="p">{})</span>
<span class="gp">tarantool&gt; </span><span class="n">box</span><span class="p">.</span><span class="n">schema</span><span class="p">.</span><span class="n">user</span><span class="p">.</span><span class="n">passwd</span><span class="p">(</span><span class="s1">&#39;</span><span class="s">admin&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="s">password&#39;</span><span class="p">)</span>
<span class="gp">tarantool&gt; </span><span class="n">console</span> <span class="o">=</span> <span class="nb">require</span><span class="p">(</span><span class="s1">&#39;</span><span class="s">console&#39;</span><span class="p">)</span>
<span class="gp">tarantool&gt; </span><span class="n">cfg</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">         &gt; </span>  <span class="n">servers</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">         &gt; </span>    <span class="p">{</span> <span class="n">uri</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">localhost:3301&#39;</span><span class="p">,</span> <span class="n">zone</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">1&#39;</span> <span class="p">},</span>
<span class="gp">         &gt; </span>    <span class="p">{</span> <span class="n">uri</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">localhost:3302&#39;</span><span class="p">,</span> <span class="n">zone</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">2&#39;</span> <span class="p">},</span>
<span class="gp">         &gt; </span>  <span class="p">},</span>
<span class="gp">         &gt; </span>  <span class="n">login</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">admin&#39;</span><span class="p">,</span>
<span class="gp">         &gt; </span>  <span class="n">password</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">password&#39;</span><span class="p">,</span>
<span class="gp">         &gt; </span>  <span class="n">redundancy</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="gp">         &gt; </span>  <span class="n">binary</span> <span class="o">=</span> <span class="mi">3301</span><span class="p">,</span>
<span class="gp">         &gt; </span><span class="p">}</span>
<span class="gp">tarantool&gt; </span><span class="n">shard</span> <span class="o">=</span> <span class="nb">require</span><span class="p">(</span><span class="s1">&#39;</span><span class="s">shard&#39;</span><span class="p">)</span>
<span class="gp">tarantool&gt; </span><span class="n">shard</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span>
<span class="gp">tarantool&gt; </span><span class="c1">-- Now put something in ...</span>
<span class="gp">tarantool&gt; </span><span class="n">shard</span><span class="p">.</span><span class="n">tester</span><span class="p">:</span><span class="n">insert</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;</span><span class="s">Tuple #1&#39;</span><span class="p">}</span>
</pre></div>
</div>
<p>On Terminal #2, say:</p>
<div class="highlight-tarantoolsession"><div class="highlight"><pre><span></span><span class="gp">$</span> mkdir ~/tarantool_sandbox_2
<span class="gp">$</span> <span class="nb">cd</span> ~/tarantool_sandbox_2
<span class="gp">$</span> rm -r *.snap
<span class="gp">$</span> rm -r *.xlog
<span class="gp">$</span> ~/tarantool-1.7/src/tarantool

<span class="gp">tarantool&gt; </span><span class="n">box</span><span class="p">.</span><span class="n">cfg</span><span class="p">{</span><span class="n">listen</span> <span class="o">=</span> <span class="mi">3302</span><span class="p">}</span>
<span class="gp">tarantool&gt; </span><span class="n">box</span><span class="p">.</span><span class="n">schema</span><span class="p">.</span><span class="n">space</span><span class="p">.</span><span class="n">create</span><span class="p">(</span><span class="s1">&#39;</span><span class="s">tester&#39;</span><span class="p">)</span>
<span class="gp">tarantool&gt; </span><span class="n">box</span><span class="p">.</span><span class="n">space</span><span class="p">.</span><span class="n">tester</span><span class="p">:</span><span class="n">create_index</span><span class="p">(</span><span class="s1">&#39;</span><span class="s">primary&#39;</span><span class="p">,</span> <span class="p">{})</span>
<span class="gp">tarantool&gt; </span><span class="n">box</span><span class="p">.</span><span class="n">schema</span><span class="p">.</span><span class="n">user</span><span class="p">.</span><span class="n">passwd</span><span class="p">(</span><span class="s1">&#39;</span><span class="s">admin&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="s">password&#39;</span><span class="p">)</span>
<span class="gp">tarantool&gt; </span><span class="n">console</span> <span class="o">=</span> <span class="nb">require</span><span class="p">(</span><span class="s1">&#39;</span><span class="s">console&#39;</span><span class="p">)</span>
<span class="gp">tarantool&gt; </span><span class="n">cfg</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">         &gt; </span>  <span class="n">servers</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">         &gt; </span>    <span class="p">{</span> <span class="n">uri</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">localhost:3301&#39;</span><span class="p">,</span> <span class="n">zone</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">1&#39;</span> <span class="p">};</span>
<span class="gp">         &gt; </span>    <span class="p">{</span> <span class="n">uri</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">localhost:3302&#39;</span><span class="p">,</span> <span class="n">zone</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">2&#39;</span> <span class="p">};</span>
<span class="gp">         &gt; </span>  <span class="p">};</span>
<span class="gp">         &gt; </span>  <span class="n">login</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">admin&#39;</span><span class="p">;</span>
<span class="gp">         &gt; </span>  <span class="n">password</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">password&#39;</span><span class="p">;</span>
<span class="gp">         &gt; </span>  <span class="n">redundancy</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="gp">         &gt; </span>  <span class="n">binary</span> <span class="o">=</span> <span class="mi">3302</span><span class="p">;</span>
<span class="gp">         &gt; </span><span class="p">}</span>
<span class="gp">tarantool&gt; </span><span class="n">shard</span> <span class="o">=</span> <span class="nb">require</span><span class="p">(</span><span class="s1">&#39;</span><span class="s">shard&#39;</span><span class="p">)</span>
<span class="gp">tarantool&gt; </span><span class="n">shard</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span>
<span class="gp">tarantool&gt; </span><span class="c1">-- Now get something out ...</span>
<span class="gp">tarantool&gt; </span><span class="n">shard</span><span class="p">.</span><span class="n">tester</span><span class="p">:</span><span class="nb">select</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span>
</pre></div>
</div>
<p>What will appear on Terminal #1 is: a loop of error messages saying &quot;Connection
refused&quot; and &quot;server check failure&quot;. This is normal. It will go on until
Terminal #2 process starts.</p>
<p>What will appear on Terminal #2, at the end, should look like this:</p>
<div class="highlight-tarantoolsession"><div class="highlight"><pre><span></span><span class="gp">tarantool&gt; </span><span class="n">shard</span><span class="p">.</span><span class="n">tester</span><span class="p">:</span><span class="nb">select</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span>
<span class="nn">---</span>
<span class="p p-Indicator">-</span> <span class="p p-Indicator">-</span> <span class="p p-Indicator">-</span> <span class="p p-Indicator">[</span><span class="nv">1</span><span class="p p-Indicator">,</span> <span class="s">&#39;Tuple</span><span class="nv"> </span><span class="s">#1&#39;</span><span class="p p-Indicator">]</span>
<span class="nn">...</span>
</pre></div>
</div>
<p>This shows that what was inserted by Terminal #1 can be selected by Terminal #2,
via the shard module.</p>
<p>Details are on <a class="reference external" href="https://github.com/tarantool/shard">the shard section of github</a>.</p>
</div>
</div>


          
          
  <div id="disqus_thread"></div>
  <script>
    // DON'T EDIT
    (function() {
        var d = document, s = d.createElement('script');
        s.src = '//tarantooldb.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
  </script>
  <noscript>
    Please enable JavaScript to view the
    <a href="https://disqus.com/?ref_noscript" rel="nofollow">
      comments powered by Disqus.
    </a>
  </noscript>

          
  
    
      <div class="b-page_over-tail">
    
    
      <div class="b-page_over-prev">
        <a href="expirationd.html"
           class="b-prev b-ellipsis"
           title="Модуль &lt;cite&gt;expirationd&lt;/cite&gt;">Модуль <cite>expirationd</cite></a>
      </div>
    
    <div class="b-page_over-lang">
      <ul class="b-page_over-lang-list">
        <li class="b-page_over-lang-item">
          <a href="../_sources/reference_rock/shard.txt"
             class="b-page_over-lang-url"> Source </a>
        </li>
      </ul>
    </div>
    
      <div class="b-page_over-next">
        <a href="tdb.html"
           class="b-next b-ellipsis"
           title="Module &lt;cite&gt;tdb&lt;/cite&gt;">Module <cite>tdb</cite></a>
      </div>
    
    </div>
  
</div>
      </div>
    </div>
  

      </div>
    </div>

  <!-- FOOTER > -->
  
<footer class="b-footer">
  <div class="b-footer-wrapper">
    <nav class="b-footer_menu">
      
  <ul class="b-menu">
    
      <li class="b-menu-item">
        <a href="/" class="b-menu-item-url">Overview</a>
      </li>
    
      <li class="b-menu-item">
        <a href="http://try.tarantool.org" class="b-menu-item-url">Try</a>
      </li>
    
      <li class="b-menu-item">
        <a href="/doc/" class="b-menu-item-url">Documentation</a>
      </li>
    
      <li class="b-menu-item">
        <a href="/download.html" class="b-menu-item-url">Download</a>
      </li>
    
      <li class="b-menu-item">
        <a href="/careers.html" class="b-menu-item-url">Careers</a>
      </li>
    
      <li class="b-menu-item">
        <a href="http://rocks.tarantool.org" class="b-menu-item-url">Rocks</a>
      </li>
    
  </ul>

      <div class="b-footer-other">
        <a href="http://15.tarantool.org">1.5 web site and downloads</a>
      </div>
    </nav>
  </div>
</footer>

  <!-- < FOOTER -->
  <div id="mobile-checker"></div>
  </body>
</html>


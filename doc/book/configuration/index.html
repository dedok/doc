




<!doctype html>
<html>
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>5. Configuration reference</title>
    <link rel="icon" type="image/png" sizes="192x192"
          href="/theme/favicon/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32"
          href="/theme/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96"
          href="/theme/favicon/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16"
          href="/theme/favicon/favicon-16x16.png">
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.7.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
      var disqus_developer = 1;
    </script>
    <script id="dsq-count-scr"
            src="//tarantooldb.disqus.com/count.js" async/>
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/jquery.pin.min.js"></script>
    <script type="text/javascript" src="../../_static/headers.js"></script>
    <link rel="stylesheet" href="/theme/design.css">
    <link rel="stylesheet" href="/theme/pygmentize.css">
    <link rel="stylesheet" href="/theme/font-awesome.min.css">
    <link rel="stylesheet" href="../../_static/sphinx_design.css">
     
    <!--[if lt IE 9]>
      <script src="/js/ie8.js"></script>
      <link rel="stylesheet" href="/theme/ie8.css" />
    <![endif]-->
    <script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-22120502-1', 'auto');
  ga('send', 'pageview');
</script>

<!-- Rating@Mail.ru counter -->
<script type="text/javascript">
  var _tmr = _tmr || [];
  _tmr.push({id: "2284916", type: "pageView", start: (new Date()).getTime()});
  (function (d, w) {
    var ts = d.createElement("script"); ts.type = "text/javascript"; ts.async = true;
    ts.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//top-fwz1.mail.ru/js/code.js";
    var f = function () {var s = d.getElementsByTagName("script")[0]; s.parentNode.insertBefore(ts, s);};
    if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); }
  })(document, window);
</script>
<noscript>
  <div style="position:absolute;left:-10000px;">
    <img src="//top-fwz1.mail.ru/counter?id=2284916;js=na" style="border:0;"
         height="1" width="1" alt="Рейтинг@Mail.ru" />
  </div>
</noscript>
<!-- //Rating@Mail.ru counter -->


  </head>
  
  <body class="p-cols_design">
  
    <div class="b-wrapper">
      <!-- HEADER > -->
      <header class="b-header">
        <div class="b-header-wrapper">
          <nav class="b-header_menu">
            
  <ul class="b-menu">
    
      <li class="b-menu-item">
        
        <a href="http://tarantool.org" class="b-menu-item-url">Overview</a>
        
      </li>
    
      <li class="b-menu-item">
        
        <a href="http://try.tarantool.org" class="b-menu-item-url">Try</a>
        
      </li>
    
      <li class="b-menu-item">
        
        <a href="http://tarantool.org/doc/" class="b-menu-item-url p-active">Documentation</a>
        
      </li>
    
      <li class="b-menu-item">
        
        <a href="http://tarantool.org/download.html" class="b-menu-item-url">Download</a>
        
      </li>
    
      <li class="b-menu-item">
        
        <a href="http://tarantool.org/careers.html" class="b-menu-item-url">Careers</a>
        
      </li>
    
      <li class="b-menu-item">
        
        <a href="http://rocks.tarantool.org" class="b-menu-item-url">Rocks</a>
        
      </li>
    
  </ul>

          </nav>
        </div>
      </header>
      <!-- < HEADER -->

      <div class="b-content b-clearbox">
        
  <section class="b-lightgray_block b-documentation_top b-clearbox p-documentation_in">
    <div class="b-block-wrapper">
      <h2 class="b-section-title b-ellipsis" title="5. Configuration reference">
        5. Configuration reference
      </h2>
  <div class="b-doc-language_selector">
    <ul class="b-doc-language_selector-list">
    
      <li class="b-doc-language_selector-item">
      
        <a href="
  
    ../../../book/configuration/index.html
  
"
           class="b-doc-language_selector-item-url p-active"> En </a>
      
      </li>
    
      <li class="b-doc-language_selector-item">
      
        <a href="
  
    ../../ru/book/configuration/index.html
  
"
           class="b-doc-language_selector-item-url"> Ru </a>
      
      </li>
    
    </ul>
  </div>
</div>
  </section>
  
    <div class="b-cols_content b-clearbox b-doc-book/configuration/index">
      <div class="b-cols_content_left">
        
<form id="searchbox" role="search" class="search b-search" action="../../search.html" method="get">
  <input class="b-search-text" name="q" type="text"/ placeholder="Search the manual">
  <input class="b-search-but" type="submit" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>


        <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../intro.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">FAQ</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">User Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../intro.html">1. Preface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide_getting_started.html">2. Getting started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../box/index.html">3. Database</a></li>
<li class="toctree-l2"><a class="reference internal" href="../replication/index.html">4. Replication</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">5. Configuration reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../administration.html">6. Server administration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../connectors/index.html">7. Connectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules.html">8. Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../app/a_errcodes.html">9. Appendix A. List of error codes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../app/b_internals.html">10. Appendix B. Internals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../app/c_lua_tutorial.html">11. Appendix C. Lua tutorials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../app/d_vinyl/index.html">12. Appendix D. Vinyl</a></li>
<li class="toctree-l2"><a class="reference internal" href="../app/e_cookbook.html">13. Appendix E. Cookbook</a></li>
<li class="toctree-l2"><a class="reference internal" href="../app/f_c_tutorial.html">14. Appendix F. C tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../app/g_changes.html">15. Appendix G. Some significant changes in version 1.7</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../reference_lua/index.html">Lua reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference_rock/index.html">Lua rocks reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference_capi/index.html">C API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev_guide/index.html">Contributing</a></li>
</ul>

      </div>
      <div class="b-cols_content_right">
        <div class="b-cols_content_right-slot">
  <div class="b-page_header">
    <ul class="b-path-list">
      <li class="b-path-list-item">
        <a href="../../index.html"
           class="b-path-list-item-url">
          Documentation
        </a>
      </li>
      
        <li class="b-path-list-item">
          <a href="../index.html"
             class="b-path-list-item-url b-ellipsis">
            User Guide
          </a>
        </li>
      
      
      <li class="b-path-list-item">
        <div title="5. Configuration reference" class="b-path_current b-ellipsis">
          5. Configuration reference
        </div>
      </li>
      
    </ul>
  </div>

  <div class="section" id="configuration-reference">
<span id="index-book-cfg"></span><h1>5. Configuration reference<a class="headerlink" href="#configuration-reference" title="Permalink to this headline">¶</a></h1>
<p>This chapter provides a reference of options which can be set on the command
line or in an initialization file.</p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#command-options" id="id1">Command options</a></li>
<li><a class="reference internal" href="#uri" id="id2">URI</a></li>
<li><a class="reference internal" href="#initialization-file" id="id3">Initialization file</a></li>
<li><a class="reference internal" href="#configuration-parameters" id="id4">Configuration parameters</a><ul>
<li><a class="reference internal" href="#basic-parameters" id="id5">Basic parameters</a></li>
<li><a class="reference internal" href="#configuring-the-storage" id="id6">Configuring the storage</a></li>
<li><a class="reference internal" href="#snapshot-daemon" id="id7">Snapshot daemon</a></li>
<li><a class="reference internal" href="#binary-logging-and-snapshots" id="id8">Binary logging and snapshots</a></li>
<li><a class="reference internal" href="#replication" id="id9">Replication</a></li>
<li><a class="reference internal" href="#networking" id="id10">Networking</a></li>
<li><a class="reference internal" href="#logging" id="id11">Logging</a></li>
</ul>
</li>
<li><a class="reference internal" href="#local-hot-standby" id="id12">Local hot standby</a></li>
</ul>
</div>
<p>Tarantool is started by entering the command:</p>
<pre class="highlight literal-block">
$ <strong>tarantool</strong>
# OR
$ <strong>tarantool</strong> <em>options</em>
# OR
$ <strong>tarantool</strong> <em>lua-initialization-file</em> <strong>[</strong> <em>arguments</em> <strong>]</strong>
</pre>
<div class="section" id="command-options">
<h2><a class="toc-backref" href="#id1">5.1. Command options</a><a class="headerlink" href="#command-options" title="Permalink to this headline">¶</a></h2>
<dl class="option">
<dt id="cmdoption-h">
<span id="cmdoption--help"></span><code class="descname">-h</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--help</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-h" title="Permalink to this definition">¶</a></dt>
<dd><p>Print an annotated list of all available options and exit.</p>
</dd></dl>

<span class="target" id="index-tarantool-version"></span><dl class="option">
<dt id="cmdoption-V">
<span id="cmdoption--version"></span><code class="descname">-V</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--version</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-V" title="Permalink to this definition">¶</a></dt>
<dd><p>Print product name and version, for example:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> ./tarantool --version
<span class="go">Tarantool 1.7.0-1216-g73f7154</span>
<span class="go">Target: Linux-x86_64-Debug</span>
<span class="go">...</span>
</pre></div>
</div>
<p>In this example:</p>
<p>“Tarantool” is the name of the reusable asynchronous networking
programming framework.</p>
<p>The 3-number version follows the standard <code class="docutils literal"><span class="pre">&lt;major&gt;-&lt;minor&gt;-&lt;patch&gt;</span></code>
scheme, in which <code class="docutils literal"><span class="pre">&lt;major&gt;</span></code> number is changed only rarely, <code class="docutils literal"><span class="pre">&lt;minor&gt;</span></code> is
incremented for each new milestone and indicates possible incompatible
changes, and <code class="docutils literal"><span class="pre">&lt;patch&gt;</span></code> stands for the number of bug fix releases made after
the start of the milestone. For non-released versions only, there may be a
commit number and commit SHA1 to indicate how much this particular build has
diverged from the last release.</p>
<p>“Target” is the platform tarantool was built on. Some platform-specific details
may follow this line.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Tarantool uses
<a class="reference external" href="http://www.kernel.org/pub/software/scm/git/docs/git-describe.html">git describe</a>
to produce its version id, and this id can be used at any time to check
out the corresponding source from our
<a class="reference external" href="http://github.com/tarantool/tarantool.git">git repository</a>.</p>
</div>
</dd></dl>

</div>
<div class="section" id="uri">
<span id="index-uri"></span><h2><a class="toc-backref" href="#id2">5.2. URI</a><a class="headerlink" href="#uri" title="Permalink to this headline">¶</a></h2>
<p>Some configuration parameters and some functions depend on a URI, or
&quot;Universal Resource Identifier&quot;. The URI string format is similar to the
<a class="reference external" href="http://en.wikipedia.org/wiki/URI_scheme#Generic_syntax">generic syntax for a URI schema</a>.
So it may contain (in order) a user name
for login, a password, a host name or host IP address, and a port number. Only
the port number is always mandatory. The password is mandatory if the user
name is specified, unless the user name is 'guest'. So, formally, the URI
syntax is <code class="docutils literal"><span class="pre">[host:]port</span></code> or <code class="docutils literal"><span class="pre">[username:password&#64;]host:port</span></code>.
If host is omitted, then '0.0.0.0' or '[::]' is assumed,
meaning respectively any IPv4 address or any IPv6 address,
on the local machine.
If username:password is omitted, then 'guest' is assumed. Some examples:</p>
<blockquote>
<div><div class="table container">
<table border="1" class="left-align-column-1 left-align-column-2 docutils">
<colgroup>
<col width="49%" />
<col width="51%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">URI fragment</th>
<th class="head">Example</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>port</td>
<td>3301</td>
</tr>
<tr class="row-odd"><td>host:port</td>
<td>127.0.0.1:3301</td>
</tr>
<tr class="row-even"><td>username:password&#64;host:port</td>
<td>notguest:sesame&#64;mail.ru:3301</td>
</tr>
</tbody>
</table>
</div>
</div></blockquote>
<p>In certain circumstances a Unix domain socket may be used
where a URI is expected, for example &quot;unix/:/tmp/unix_domain_socket.sock&quot; or
simply &quot;/tmp/unix_domain_socket.sock&quot;.</p>
<p>A method for parsing URIs is illustrated in <a class="reference internal" href="../app/e_cookbook.html#e-cookbook-uri-parse"><span class="std std-ref">Appendix E: Cookbook</span></a>.</p>
</div>
<div class="section" id="initialization-file">
<span id="index-init-label"></span><h2><a class="toc-backref" href="#id3">5.3. Initialization file</a><a class="headerlink" href="#initialization-file" title="Permalink to this headline">¶</a></h2>
<p>If the command to start Tarantool includes <span class="ccodei">lua-initialization-file</span>, then
Tarantool begins by invoking the Lua program in the file, which by convention
may have the name &quot;<code class="docutils literal"><span class="pre">script.lua</span></code>&quot;. The Lua program may get further arguments
from the command line or may use operating-system functions, such as <code class="docutils literal"><span class="pre">getenv()</span></code>.
The Lua program almost always begins by invoking <code class="docutils literal"><span class="pre">box.cfg()</span></code>, if the database
server will be used or if ports need to be opened. For example, suppose
<code class="docutils literal"><span class="pre">script.lua</span></code> contains the lines</p>
<div class="highlight-lua"><div class="highlight"><pre><span></span><span class="cp">#!/usr/bin/env tarantool</span>
<span class="n">box</span><span class="p">.</span><span class="n">cfg</span><span class="p">{</span>
    <span class="n">listen</span>              <span class="o">=</span> <span class="nb">os.getenv</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">LISTEN_URI&quot;</span><span class="p">),</span>
    <span class="n">slab_alloc_arena</span>    <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
    <span class="n">pid_file</span>            <span class="o">=</span> <span class="s2">&quot;</span><span class="s">tarantool.pid&quot;</span><span class="p">,</span>
    <span class="n">rows_per_wal</span>        <span class="o">=</span> <span class="mi">50</span>
<span class="p">}</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="s">Starting &#39;</span><span class="p">,</span> <span class="n">arg</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<p>and suppose the environment variable LISTEN_URI contains 3301,
and suppose the command line is <code class="docutils literal"><span class="pre">~/tarantool/src/tarantool</span> <span class="pre">script.lua</span> <span class="pre">ARG</span></code>.
Then the screen might look like this:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> <span class="nb">export</span> <span class="nv">LISTEN_URI</span><span class="o">=</span>3301
<span class="gp">$</span> ~/tarantool/src/tarantool script.lua ARG
<span class="go">... main/101/script.lua C&gt; version 1.7.0-1216-g73f7154</span>
<span class="go">... main/101/script.lua C&gt; log level 5</span>
<span class="go">... main/101/script.lua I&gt; mapping 107374184 bytes for a shared arena...</span>
<span class="go">... main/101/script.lua I&gt; recovery start</span>
<span class="go">... main/101/script.lua I&gt; recovering from &#39;./00000000000000000000.snap&#39;</span>
<span class="go">... main/101/script.lua I&gt; primary: bound to 0.0.0.0:3301</span>
<span class="go">... main/102/leave_local_hot_standby I&gt; ready to accept requests</span>
<span class="go">Starting  ARG</span>
<span class="go">... main C&gt; entering the event loop</span>
</pre></div>
</div>
<p>If one wishes to start an interactive session on the same terminal after
initialization is complete, one can use <a class="reference internal" href="../../reference_lua/console.html#console-start"><span class="std std-ref">console.start()</span></a>.</p>
</div>
<div class="section" id="configuration-parameters">
<span id="index-snapshot-daemon"></span><span id="index-wal-mode"></span><span id="index-wal-dir"></span><span id="index-snap-dir"></span><span id="index-replication-source"></span><span id="index-slab-alloc-arena"></span><span id="index-replication-port"></span><span id="index-local-hot-standby"></span><h2><a class="toc-backref" href="#id4">5.4. Configuration parameters</a><a class="headerlink" href="#configuration-parameters" title="Permalink to this headline">¶</a></h2>
<p>Configuration parameters have the form:</p>
<pre class="highlight literal-block">
box.cfg{ <em>key = value</em> [, <em>key = value</em> ...]]
</pre>
<p>Since <code class="docutils literal"><span class="pre">box.cfg</span></code> may contain many configuration parameters and since some of the
parameters (such as directory addresses) are semi-permanent, it's best to keep
<code class="docutils literal"><span class="pre">box.cfg</span></code> in a Lua file. Typically this Lua file is the initialization file
which is specified on the tarantool command line.</p>
<p>Most configuration parameters are for allocating resources, opening ports, and
specifying database behavior. All parameters are optional. A few parameters are
dynamic, that is, they can be changed at runtime by calling <code class="docutils literal"><span class="pre">box.cfg{}</span></code>
a second time.</p>
<p>To see all the non-null parameters, say <code class="docutils literal"><span class="pre">box.cfg</span></code> (no parentheses). To see a
particular parameter, for example the listen address, say <code class="docutils literal"><span class="pre">box.cfg.listen</span></code>.</p>
<p>The following sections describe all parameters for basic operation, for storage,
for binary logging and snapshots, for replication, for networking, and for logging.</p>
<div class="section" id="basic-parameters">
<h3><a class="toc-backref" href="#id5">5.4.1. Basic parameters</a><a class="headerlink" href="#basic-parameters" title="Permalink to this headline">¶</a></h3>
<dl class="confval">
<dt id="confval-background">
<code class="descname">background</code><a class="headerlink" href="#confval-background" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the server as a background task. The <a class="reference internal" href="#cfg-logging-logger"><span class="std std-ref">logger</span></a> and
<a class="reference internal" href="#cfg-basic-pid-file"><span class="std std-ref">pid_file</span></a> parameters must be non-null for this to work.</p>
<p>Type: boolean <br />
Default: false <br />
Dynamic: no <br /></p>
</dd></dl>

<dl class="confval">
<dt id="confval-coredump">
<code class="descname">coredump</code><a class="headerlink" href="#confval-coredump" title="Permalink to this definition">¶</a></dt>
<dd><p>Deprecated. Do not use.</p>
<p>Type: boolean <br />
Default: false <br />
Dynamic: no <br /></p>
</dd></dl>

<span class="target" id="cfg-basic-custom-proc-title"></span><dl class="confval">
<dt id="confval-custom_proc_title">
<code class="descname">custom_proc_title</code><a class="headerlink" href="#confval-custom_proc_title" title="Permalink to this definition">¶</a></dt>
<dd><p>Add the given string to the server's <a class="reference internal" href="../administration.html#administration-proctitle"><span class="std std-ref">Process title</span></a>
(what’s shown in the COMMAND column for <code class="samp docutils literal"><span class="pre">ps</span> <span class="pre">-ef</span></code> and <code class="samp docutils literal"><span class="pre">top</span> <span class="pre">-c</span></code> commands).</p>
<p>For example, ordinarily <code class="samp docutils literal"><span class="pre">ps</span> <span class="pre">-ef</span></code> shows the Tarantool server process thus:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> ps -ef <span class="p">|</span> grep tarantool
<span class="go">1000     14939 14188  1 10:53 pts/2    00:00:13 tarantool &lt;running&gt;</span>
</pre></div>
</div>
<p>But if the configuration parameters include
<code class="docutils literal"><span class="pre">custom_proc_title='sessions'</span></code> then the output looks like:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> ps -ef <span class="p">|</span> grep tarantool
<span class="go">1000     14939 14188  1 10:53 pts/2    00:00:16 tarantool &lt;running&gt;: sessions</span>
</pre></div>
</div>
<p>Type: string <br />
Default: null <br />
Dynamic: yes <br /></p>
</dd></dl>

<span class="target" id="cfg-basic-listen"></span><dl class="confval">
<dt id="confval-listen">
<code class="descname">listen</code><a class="headerlink" href="#confval-listen" title="Permalink to this definition">¶</a></dt>
<dd><p>The read/write data port number or <a class="reference internal" href="#index-uri"><span class="std std-ref">URI</span></a> (Universal Resource Identifier)
string. Has no default value, so <strong>must be specified</strong> if connections will
occur from remote clients that do not use the <a class="reference internal" href="../administration.html#administration-admin-ports"><span class="std std-ref">“admin port”</span></a>.
Connections made with <code class="samp docutils literal"><span class="pre">listen=</span><em><span class="pre">URI</span></em></code> are sometimes called &quot;binary protocol&quot; or &quot;primary port&quot; connections.</p>
<p>A typical value is 3301. The listen parameter may also be set for
<a class="reference internal" href="#book-cfg-local-hot-standby"><span class="std std-ref">local hot standby</span></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">A replica also binds to this port, and accepts connections, but these
connections can only serve reads until the replica becomes a master.</p>
</div>
<p>Type: integer or string <br />
Default: null <br />
Dynamic: yes <br /></p>
</dd></dl>

<span class="target" id="cfg-basic-pid-file"></span><dl class="confval">
<dt id="confval-pid_file">
<code class="descname">pid_file</code><a class="headerlink" href="#confval-pid_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Store the process id in this file. Can be relative to <a class="reference internal" href="#cfg-basic-work-dir"><span class="std std-ref">work_dir</span></a>.
A typical value is “<code class="file docutils literal"><span class="pre">tarantool.pid</span></code>”.</p>
<p>Type: string <br />
Default: null <br />
Dynamic: no <br /></p>
</dd></dl>

<span class="target" id="cfg-basic-read-only"></span><dl class="confval">
<dt id="confval-read_only">
<code class="descname">read_only</code><a class="headerlink" href="#confval-read_only" title="Permalink to this definition">¶</a></dt>
<dd><p>Put the server in read-only mode. After this, any requests that try to change
data will fail with error ER_READONLY.</p>
<p>Type: boolean <br />
Default: false <br />
Dynamic: yes <br /></p>
</dd></dl>

<span class="target" id="cfg-basic-snap-dir"></span><dl class="confval">
<dt id="confval-snap_dir">
<code class="descname">snap_dir</code><a class="headerlink" href="#confval-snap_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>A directory where snapshot (.snap) files will be stored. Can be relative to
<a class="reference internal" href="#cfg-basic-work-dir"><span class="std std-ref">work_dir</span></a>. If not specified, defaults to work_dir.
See also <a class="reference internal" href="#cfg-basic-wal-dir"><span class="std std-ref">wal_dir</span></a>.</p>
<p>Type: string <br />
Default: &quot;.&quot; <br />
Dynamic: no <br /></p>
</dd></dl>

<span class="target" id="cfg-basic-vinyl-dir"></span><dl class="confval">
<dt id="confval-vinyl_dir">
<code class="descname">vinyl_dir</code><a class="headerlink" href="#confval-vinyl_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>A directory where vinyl files or subdirectories will be stored. Can be relative to
<a class="reference internal" href="#cfg-basic-work-dir"><span class="std std-ref">work_dir</span></a>. If not specified, defaults to work_dir.</p>
<p>Type: string <br />
Default: &quot;.&quot; <br />
Dynamic: no <br /></p>
</dd></dl>

<dl class="confval">
<dt id="confval-username">
<code class="descname">username</code><a class="headerlink" href="#confval-username" title="Permalink to this definition">¶</a></dt>
<dd><p>UNIX user name to switch to after start.</p>
<p>Type: string <br />
Default: null <br />
Dynamic: no <br /></p>
</dd></dl>

<span class="target" id="cfg-basic-wal-dir"></span><dl class="confval">
<dt id="confval-wal_dir">
<code class="descname">wal_dir</code><a class="headerlink" href="#confval-wal_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>A directory where write-ahead log (.xlog) files are stored. Can be
relative to <a class="reference internal" href="#cfg-basic-work-dir"><span class="std std-ref">work_dir</span></a>. Sometimes wal_dir
and <a class="reference internal" href="#cfg-basic-snap-dir"><span class="std std-ref">snap_dir</span></a> are specified with different values, so that
write-ahead log files and snapshot files can be stored on different disks. If not
specified, defaults to work_dir.</p>
<p>Type: string <br />
Default: &quot;.&quot; <br />
Dynamic: no <br /></p>
</dd></dl>

<span class="target" id="cfg-basic-work-dir"></span><dl class="confval">
<dt id="confval-work_dir">
<code class="descname">work_dir</code><a class="headerlink" href="#confval-work_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>A directory where database working files will be stored. The server
switches to work_dir with <em class="manpage">chdir(2)</em> after start. Can be
relative to the current directory. If not specified, defaults to
the current directory. Other directory parameters may be relative to work_dir,
for example <br />
<span class="ccode">box.cfg{work_dir='/home/user/A',wal_dir='B',snap_dir='C'}</span> <br />
will put xlog files in /home/user/A/B, snapshot files in /home/user/A/C,
and all other files or subdirectories in /home/user/A.</p>
<p>Type: string <br />
Default: null <br />
Dynamic: no <br /></p>
</dd></dl>

</div>
<div class="section" id="configuring-the-storage">
<h3><a class="toc-backref" href="#id6">5.4.2. Configuring the storage</a><a class="headerlink" href="#configuring-the-storage" title="Permalink to this headline">¶</a></h3>
<span class="target" id="cfg-storage-slab-alloc-arena"></span><dl class="confval">
<dt id="confval-slab_alloc_arena">
<code class="descname">slab_alloc_arena</code><a class="headerlink" href="#confval-slab_alloc_arena" title="Permalink to this definition">¶</a></dt>
<dd><p>How much memory Tarantool allocates to actually store tuples, in gigabytes.
When the limit is reached, INSERT or UPDATE requests begin failing with
error <code class="xref std std-errcode docutils literal"><span class="pre">ER_MEMORY_ISSUE</span></code>. While the server does not go beyond the defined
limit to allocate tuples, there is additional memory used to store indexes
and connection information. Depending on actual configuration and workload,
Tarantool can consume up to 20% more than the limit set here.</p>
<p>Type: float <br />
Default: 1.0 <br />
Dynamic: no <br /></p>
</dd></dl>

<span class="target" id="cfg-storage-slab-alloc-factor"></span><dl class="confval">
<dt id="confval-slab_alloc_factor">
<code class="descname">slab_alloc_factor</code><a class="headerlink" href="#confval-slab_alloc_factor" title="Permalink to this definition">¶</a></dt>
<dd><p>Use slab_alloc_factor as the multiplier for computing the sizes of memory
chunks that tuples are stored in. A lower value may result in less wasted
memory depending on the total amount of memory available and the
distribution of item sizes.</p>
<p>Type: float <br />
Default: 1.1 <br />
Dynamic: no <br /></p>
</dd></dl>

<span class="target" id="cfg-storage-slab-alloc-maximal"></span><dl class="confval">
<dt id="confval-slab_alloc_maximal">
<code class="descname">slab_alloc_maximal</code><a class="headerlink" href="#confval-slab_alloc_maximal" title="Permalink to this definition">¶</a></dt>
<dd><p>Size of the largest allocation unit. It can be increased if it
is necessary to store large tuples.</p>
<p>Type: integer <br />
Default: 1048576 <br />
Dynamic: no <br /></p>
</dd></dl>

<span class="target" id="cfg-storage-slab-alloc-minimal"></span><dl class="confval">
<dt id="confval-slab_alloc_minimal">
<code class="descname">slab_alloc_minimal</code><a class="headerlink" href="#confval-slab_alloc_minimal" title="Permalink to this definition">¶</a></dt>
<dd><p>Size of the smallest allocation unit. It can be decreased if most
of the tuples are very small. The value must be between 8 and 1048280 inclusive.</p>
<p>Type: integer <br />
Default: 16 <br />
Dynamic: no <br /></p>
</dd></dl>

<span class="target" id="cfg-storage-vinyl"></span><dl class="confval">
<dt id="confval-vinyl">
<code class="descname">vinyl</code><a class="headerlink" href="#confval-vinyl" title="Permalink to this definition">¶</a></dt>
<dd><p>The default vinyl configuration can be changed with</p>
<pre class="highlight literal-block">
vinyl = {
  run_age_wm = <em>number</em>,
  run_age_period = <em>number of seconds</em>,
  memory_limit = <em>number of gigabytes</em>,
  compact_wm = <em>number</em>,
  threads = <em>number</em>,
  run_age = <em>number</em>,
  run_prio = <em>number</em>,
}
</pre>
<p>This method may change in the future.</p>
<p>Default values are:</p>
<div class="highlight highlight-default"><div class="highlight"><pre><span></span><span class="n">vinyl</span> <span class="o">=</span> <span class="p">{</span>
  <span class="n">run_age_wm</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
  <span class="n">run_age_period</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
  <span class="n">memory_limit</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
  <span class="n">compact_wm</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
  <span class="n">threads</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
  <span class="n">run_age</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
  <span class="n">run_prio</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="snapshot-daemon">
<span id="book-cfg-snapshot-daemon"></span><h3><a class="toc-backref" href="#id7">5.4.3. Snapshot daemon</a><a class="headerlink" href="#snapshot-daemon" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>The snapshot daemon is a fiber which is constantly running.
At intervals, it may make new snapshot (.snap) files and
then may remove old snapshot files. If the snapshot daemon
removes an old snapshot file, it will also remove any
write-ahead log (.xlog) files that are older than the
snapshot file and contain information that is present in
the snapshot file.</p>
<p>The <a class="reference internal" href="#cfg-snapshot-daemon-snapshot-period"><span class="std std-ref">snapshot_period</span></a> and <a class="reference internal" href="#cfg-snapshot-daemon-snapshot-count"><span class="std std-ref">snapshot_count</span></a>
configuration settings determine how long the intervals are,
and how many snapshots should exist before removals occur.</p>
</div></blockquote>
<span class="target" id="cfg-snapshot-daemon-snapshot-period"></span><dl class="confval">
<dt id="confval-snapshot_period">
<code class="descname">snapshot_period</code><a class="headerlink" href="#confval-snapshot_period" title="Permalink to this definition">¶</a></dt>
<dd><p>The interval between actions by the snapshot daemon, in seconds.
If <code class="docutils literal"><span class="pre">snapshot_period</span></code> is set to a value greater than zero,
and there is activity which causes change to a database,
then the snapshot daemon will call <a class="reference internal" href="../box/admin.html#admin-snapshot"><span class="std std-ref">box.snapshot</span></a> every
<code class="docutils literal"><span class="pre">snapshot_period</span></code> seconds, creating a new snapshot file each time.</p>
<p>For example: <code class="docutils literal"><span class="pre">box.cfg{snapshot_period=3600}</span></code>
will cause the snapshot daemon to create a new database snapshot
once per hour.</p>
<p>Type: integer <br />
Default: 0 <br />
Dynamic: yes <br /></p>
</dd></dl>

<span class="target" id="cfg-snapshot-daemon-snapshot-count"></span><dl class="confval">
<dt id="confval-snapshot_count">
<code class="descname">snapshot_count</code><a class="headerlink" href="#confval-snapshot_count" title="Permalink to this definition">¶</a></dt>
<dd><p>The maximum number of snapshots that may exist on the snap_dir
directory before the snapshot daemon will remove old snapshots.
If snapshot_count equals zero, then the snapshot daemon does not remove
old snapshots.
For example:</p>
<div class="highlight-lua"><div class="highlight"><pre><span></span><span class="n">box</span><span class="p">.</span><span class="n">cfg</span><span class="p">{</span>
    <span class="n">snapshot_period</span> <span class="o">=</span> <span class="mi">3600</span><span class="p">,</span>
    <span class="n">snapshot_count</span>  <span class="o">=</span> <span class="mi">10</span>
<span class="p">}</span>
</pre></div>
</div>
<p>will cause the snapshot daemon to create a new snapshot each hour until
it has created ten snapshots. After that, it will remove the oldest
snapshot (and any associated write-ahead-log files) after creating a new one.</p>
<p>Type: integer <br />
Default: 6 <br />
Dynamic: yes <br /></p>
</dd></dl>

</div>
<div class="section" id="binary-logging-and-snapshots">
<h3><a class="toc-backref" href="#id8">5.4.4. Binary logging and snapshots</a><a class="headerlink" href="#binary-logging-and-snapshots" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><a class="reference internal" href="#cfg-binary-logging-snapshots-panic-on-snap-error"><span class="std std-ref">panic_on_snap_error</span></a>, <br />
<a class="reference internal" href="#cfg-binary-logging-snapshots-panic-on-wal-error"><span class="std std-ref">panic_on_wal_error</span></a>, <br />
<a class="reference internal" href="#cfg-binary-logging-snapshots-rows-per-wal"><span class="std std-ref">rows_per_wal</span></a>, <br />
<a class="reference internal" href="#cfg-binary-logging-snapshots-snap-io-rate-limit"><span class="std std-ref">snap_io_rate_limit</span></a>, <br />
<a class="reference internal" href="#cfg-binary-logging-snapshots-wal-mode"><span class="std std-ref">wal_mode</span></a>, <br />
<a class="reference internal" href="#cfg-binary-logging-snapshots-wal-dir-rescan-delay"><span class="std std-ref">wal_dir_rescan_delay</span></a> <br /></div></blockquote>
<span class="target" id="cfg-binary-logging-snapshots-panic-on-snap-error"></span><dl class="confval">
<dt id="confval-panic_on_snap_error">
<code class="descname">panic_on_snap_error</code><a class="headerlink" href="#confval-panic_on_snap_error" title="Permalink to this definition">¶</a></dt>
<dd><p>If there is an error while reading the snapshot file
(at server start), abort.</p>
<p>Type: boolean <br />
Default: true <br />
Dynamic: no <br /></p>
</dd></dl>

<span class="target" id="cfg-binary-logging-snapshots-panic-on-wal-error"></span><dl class="confval">
<dt id="confval-panic_on_wal_error">
<code class="descname">panic_on_wal_error</code><a class="headerlink" href="#confval-panic_on_wal_error" title="Permalink to this definition">¶</a></dt>
<dd><p>If there is an error while reading a write-ahead log
file (at server start or to relay to a replica), abort.</p>
<p>Type: boolean <br />
Default: true <br />
Dynamic: yes <br /></p>
</dd></dl>

<span class="target" id="cfg-binary-logging-snapshots-rows-per-wal"></span><dl class="confval">
<dt id="confval-rows_per_wal">
<code class="descname">rows_per_wal</code><a class="headerlink" href="#confval-rows_per_wal" title="Permalink to this definition">¶</a></dt>
<dd><p>How many log records to store in a single write-ahead log file.
When this limit is reached, Tarantool creates another WAL file
named <code class="samp docutils literal"><em><span class="pre">&lt;first-lsn-in-wal&gt;</span></em><span class="pre">.xlog</span></code>. This can be useful for
simple rsync-based backups.</p>
<p>Type: integer <br />
Default: 500000 <br />
Dynamic: no <br /></p>
</dd></dl>

<span class="target" id="cfg-binary-logging-snapshots-snap-io-rate-limit"></span><dl class="confval">
<dt id="confval-snap_io_rate_limit">
<code class="descname">snap_io_rate_limit</code><a class="headerlink" href="#confval-snap_io_rate_limit" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduce the throttling effect of <a class="reference internal" href="../box/admin.html#admin-snapshot"><span class="std std-ref">box.snapshot</span></a> on
INSERT/UPDATE/DELETE performance by setting a limit on how many
megabytes per second it can write to disk. The same can be
achieved by splitting <a class="reference internal" href="#cfg-basic-wal-dir"><span class="std std-ref">wal_dir</span></a> and <a class="reference internal" href="#cfg-basic-snap-dir"><span class="std std-ref">snap_dir</span></a>
locations and moving snapshots to a separate disk.</p>
<p>Type: float <br />
Default: null <br />
Dynamic: <strong>yes</strong> <br /></p>
</dd></dl>

<span class="target" id="cfg-binary-logging-snapshots-wal-mode"></span><dl class="confval">
<dt id="confval-wal_mode">
<code class="descname">wal_mode</code><a class="headerlink" href="#confval-wal_mode" title="Permalink to this definition">¶</a></dt>
<dd><p>Specify fiber-WAL-disk synchronization mode as:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">none</span></code>: write-ahead log is not maintained;</li>
<li><code class="docutils literal"><span class="pre">write</span></code>: fibers wait for their data to be written to
the write-ahead log (no <em class="manpage">fsync(2)</em>);</li>
<li><code class="docutils literal"><span class="pre">fsync</span></code>: fibers wait for their data, <em class="manpage">fsync(2)</em>
follows each <em class="manpage">write(2)</em>;</li>
</ul>
<p>Type: string <br />
Default: &quot;write&quot; <br />
Dynamic: <strong>yes</strong> <br /></p>
</dd></dl>

<span class="target" id="cfg-binary-logging-snapshots-wal-dir-rescan-delay"></span><dl class="confval">
<dt id="confval-wal_dir_rescan_delay">
<code class="descname">wal_dir_rescan_delay</code><a class="headerlink" href="#confval-wal_dir_rescan_delay" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of seconds between periodic scans of the write-ahead-log
file directory, when checking for changes to write-ahead-log
files for the sake of replication or local hot standby.</p>
<p>Type: float <br />
Default: 2 <br />
Dynamic: no <br /></p>
</dd></dl>

</div>
<div class="section" id="replication">
<h3><a class="toc-backref" href="#id9">5.4.5. Replication</a><a class="headerlink" href="#replication" title="Permalink to this headline">¶</a></h3>
<span class="target" id="cfg-replication-replication-source"></span><dl class="confval">
<dt id="confval-replication_source">
<code class="descname">replication_source</code><a class="headerlink" href="#confval-replication_source" title="Permalink to this definition">¶</a></dt>
<dd><p>If replication_source is not an empty string, the server is considered
to be a Tarantool <a class="reference internal" href="../replication/index.html#index-box-replication"><span class="std std-ref">replica</span></a>. The replica server will try to connect to the
master which replication_source specifies with a <a class="reference internal" href="#index-uri"><span class="std std-ref">URI</span></a> (Universal
Resource Identifier), for example <code class="samp docutils literal"><em><span class="pre">konstantin</span></em><span class="pre">:</span><em><span class="pre">secret_password</span></em><span class="pre">&#64;</span><em><span class="pre">tarantool.org</span></em><span class="pre">:</span><em><span class="pre">3301</span></em></code>.</p>
<p>If there is more than one replication source in a cluster, specify an
array of URIs, for example <br />
<span class="ccode">box.cfg{replication_source = {</span><span class="ccodei">uri#1,uri#2</span><span class="ccode">}}</span> <br /></p>
<p>If one of the URIs is &quot;self&quot; -- that is, if one of
the URIs is for the same server that <span class="ccode">box.cfg{}</span> is being executed on --
then it is ignored. Thus it is possible to use the same replication_source
specification on multiple servers.</p>
<p>The default user name is ‘guest’.
A replica server does not accept data-change requests on the <a class="reference internal" href="#cfg-basic-listen"><span class="std std-ref">listen</span></a> port.
The replication_source parameter is
dynamic, that is, to enter master mode, simply set replication_source
to an empty string and issue <code class="code docutils literal"><span class="pre">box.cfg{replication_source=</span></code><code class="samp docutils literal"><em><span class="pre">new-value</span></em></code><code class="code docutils literal"><span class="pre">}</span></code>.</p>
<p>Type: string <br />
Default: null <br />
Dynamic: <strong>yes</strong> <br /></p>
</dd></dl>

</div>
<div class="section" id="networking">
<h3><a class="toc-backref" href="#id10">5.4.6. Networking</a><a class="headerlink" href="#networking" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><a class="reference internal" href="#cfg-networking-io-collect-interval"><span class="std std-ref">io_collect_interval</span></a>, <br />
<a class="reference internal" href="#cfg-networking-readahead"><span class="std std-ref">readahead</span></a>  <br /></div></blockquote>
<span class="target" id="cfg-networking-io-collect-interval"></span><dl class="confval">
<dt id="confval-io_collect_interval">
<code class="descname">io_collect_interval</code><a class="headerlink" href="#confval-io_collect_interval" title="Permalink to this definition">¶</a></dt>
<dd><p>The server will sleep for io_collect_interval seconds between iterations
of the event loop. Can be used to reduce CPU load in deployments in which
the number of client connections is large, but requests are not so frequent
(for example, each connection issues just a handful of requests per second).</p>
<p>Type: float <br />
Default: null <br />
Dynamic: <strong>yes</strong> <br /></p>
</dd></dl>

<span class="target" id="cfg-networking-readahead"></span><dl class="confval">
<dt id="confval-readahead">
<code class="descname">readahead</code><a class="headerlink" href="#confval-readahead" title="Permalink to this definition">¶</a></dt>
<dd><p>The size of the read-ahead buffer associated with a client connection. The
larger the buffer, the more memory an active connection consumes and the
more requests can be read from the operating system buffer in a single
system call. The rule of thumb is to make sure the buffer can contain at
least a few dozen requests. Therefore, if a typical tuple in a request is
large, e.g. a few kilobytes or even megabytes, the read-ahead buffer size
should be increased. If batched request processing is not used, it’s prudent
to leave this setting at its default.</p>
<p>Type: integer <br />
Default: 16320 <br />
Dynamic: <strong>yes</strong> <br /></p>
</dd></dl>

</div>
<div class="section" id="logging">
<h3><a class="toc-backref" href="#id11">5.4.7. Logging</a><a class="headerlink" href="#logging" title="Permalink to this headline">¶</a></h3>
<span class="target" id="cfg-logging-log-level"></span><dl class="confval">
<dt id="confval-log_level">
<code class="descname">log_level</code><a class="headerlink" href="#confval-log_level" title="Permalink to this definition">¶</a></dt>
<dd><p>How verbose the logging is. There are six log verbosity classes:</p>
<ul class="simple">
<li>1 – <code class="docutils literal"><span class="pre">SYSERROR</span></code></li>
<li>2 – <code class="docutils literal"><span class="pre">ERROR</span></code></li>
<li>3 – <code class="docutils literal"><span class="pre">CRITICAL</span></code></li>
<li>4 – <code class="docutils literal"><span class="pre">WARNING</span></code></li>
<li>5 – <code class="docutils literal"><span class="pre">INFO</span></code></li>
<li>6 – <code class="docutils literal"><span class="pre">DEBUG</span></code></li>
</ul>
<p>By setting log_level, one can enable logging of all classes below
or equal to the given level. Tarantool prints its logs to the standard
error stream by default, but this can be changed with the <a class="reference internal" href="#cfg-logging-logger"><span class="std std-ref">logger</span></a>
configuration parameter.</p>
<p>Type: integer <br />
Default: 5 <br />
Dynamic: <strong>yes</strong> <br /></p>
</dd></dl>

<span class="target" id="cfg-logging-logger"></span><dl class="confval">
<dt id="confval-logger">
<code class="descname">logger</code><a class="headerlink" href="#confval-logger" title="Permalink to this definition">¶</a></dt>
<dd><p>By default, the log is sent to the standard error stream (<code class="docutils literal"><span class="pre">stderr</span></code>). If
<code class="docutils literal"><span class="pre">logger</span></code> is specified, the log is sent to a file, or to a pipe, or to
the system logger.</p>
<p>Example setting:</p>
<div class="highlight-lua"><div class="highlight"><pre><span></span><span class="n">box</span><span class="p">.</span><span class="n">cfg</span><span class="p">{</span><span class="n">logger</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">tarantool.log&#39;</span><span class="p">}</span>
<span class="c1">-- or</span>
<span class="n">box</span><span class="p">.</span><span class="n">cfg</span><span class="p">{</span><span class="n">logger</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">file: tarantool.log&#39;</span><span class="p">}</span>
</pre></div>
</div>
<p>This will open the file <code class="docutils literal"><span class="pre">tarantool.log</span></code> for output on the server’s default
directory. If the <code class="docutils literal"><span class="pre">logger</span></code> string has no prefix or has the prefix &quot;file:&quot;,
then the string is interpreted as a file path.</p>
<p>Example setting:</p>
<div class="highlight-lua"><div class="highlight"><pre><span></span><span class="n">box</span><span class="p">.</span><span class="n">cfg</span><span class="p">{</span><span class="n">logger</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">| cronolog tarantool.log&#39;</span><span class="p">}</span>
<span class="c1">-- or</span>
<span class="n">box</span><span class="p">.</span><span class="n">cfg</span><span class="p">{</span><span class="n">logger</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">pipe: cronolog tarantool.log&#39;</span><span class="p">}</span><span class="s1">&#39;</span>
</pre></div>
</div>
<p>This will start the program <code class="docutils literal"><span class="pre">cronolog</span></code> when the server starts, and
will send all log messages to the standard input (<code class="docutils literal"><span class="pre">stdin</span></code>) of cronolog.
If the <code class="docutils literal"><span class="pre">logger</span></code> string begins with '|' or has the prefix &quot;pipe:&quot;,
then the string is interpreted as a Unix
<a class="reference external" href="https://en.wikipedia.org/wiki/Pipeline_%28Unix%29">pipeline</a>.</p>
<p>Example setting:</p>
<div class="highlight-lua"><div class="highlight"><pre><span></span><span class="n">box</span><span class="p">.</span><span class="n">cfg</span><span class="p">{</span><span class="n">logger</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">syslog:identity=tarantool&#39;</span><span class="p">}</span>
<span class="c1">-- or</span>
<span class="n">box</span><span class="p">.</span><span class="n">cfg</span><span class="p">{</span><span class="n">logger</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">syslog:facility=user&#39;</span><span class="p">}</span>
<span class="c1">-- or</span>
<span class="n">box</span><span class="p">.</span><span class="n">cfg</span><span class="p">{</span><span class="n">logger</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">syslog:identity=tarantool,facility=user&#39;</span><span class="p">}</span>
</pre></div>
</div>
<p>If the <code class="docutils literal"><span class="pre">logger</span></code> string has the prefix &quot;syslog:&quot;, then the string is
interpreted as a message for the
<a class="reference external" href="http://www.rfc-base.org/txt/rfc-5424.txt">syslogd</a> program which normally
is running in the background of any Unix-like platform. One can optionally
specify an <code class="docutils literal"><span class="pre">identity</span></code>, a <code class="docutils literal"><span class="pre">facility</span></code>, or both. The <code class="docutils literal"><span class="pre">identity</span></code> is an
arbitrary string, default value = <code class="docutils literal"><span class="pre">tarantool</span></code>, which will be placed at
the beginning of all messages. The facility is an abbreviation for the
name of one of the <a class="reference external" href="https://en.wikipedia.org/wiki/Syslog">syslog</a>
facilities, default value = <code class="docutils literal"><span class="pre">user</span></code>, which
tell syslogd where the message should go.</p>
<p>Possible values for <code class="docutils literal"><span class="pre">facility</span></code> are: auth, authpriv, cron, daemon, ftp,
kern, lpr, mail, news, security, syslog, user, uucp, local0, local1, local2,
local3, local4, local5, local6, local7.</p>
<p>The <code class="docutils literal"><span class="pre">facility</span></code> setting is currently ignored but will be used in the future.</p>
<p>When logging to a file, tarantool reopens the log on SIGHUP. When log is
a program, its pid is saved in the <a class="reference internal" href="../../reference_lua/log.html#log-logger-pid"><span class="std std-ref">log.logger_pid</span></a> variable. You need
to send it a signal to rotate logs.</p>
<p>Type: string <br />
Default: null <br />
Dynamic: no <br /></p>
</dd></dl>

<span class="target" id="cfg-logging-logger-nonblock"></span><dl class="confval">
<dt id="confval-logger_nonblock">
<code class="descname">logger_nonblock</code><a class="headerlink" href="#confval-logger_nonblock" title="Permalink to this definition">¶</a></dt>
<dd><p>If <code class="docutils literal"><span class="pre">logger_nonblock</span></code> equals true, Tarantool does not block on the log
file descriptor when it’s not ready for write, and drops the message
instead. If <a class="reference internal" href="#cfg-logging-log-level"><span class="std std-ref">log_level</span></a> is high, and a lot of messages go to the
log file, setting <code class="docutils literal"><span class="pre">logger_nonblock</span></code> to true may improve logging
performance at the cost of some log messages getting lost.</p>
<p>Type: boolean <br />
Default: true <br />
Dynamic: no <br /></p>
</dd></dl>

<span class="target" id="cfg-logging-too-long-threshold"></span><dl class="confval">
<dt id="confval-too_long_threshold">
<code class="descname">too_long_threshold</code><a class="headerlink" href="#confval-too_long_threshold" title="Permalink to this definition">¶</a></dt>
<dd><p>If processing a request takes longer than the given value (in seconds),
warn about it in the log. Has effect only if <a class="reference internal" href="#cfg-logging-log-level"><span class="std std-ref">log_level</span></a> is
more than or equal to 4 (WARNING).</p>
<p>Type: float <br />
Default: 0.5 <br />
Dynamic: <strong>yes</strong> <br /></p>
</dd></dl>

<p id="cfg-logging-logging-example"><strong>Logging example:</strong></p>
<p>This will illustrate how &quot;rotation&quot; works, that is, what happens when
the server is writing to a log and signals are used when archiving it.</p>
<p>Start with two terminal shells, Terminal #1 and Terminal #2.</p>
<p>On Terminal #1: start an interactive Tarantool session, then say the logging will
go to <cite>Log_file</cite>, then put a message &quot;Log Line #1&quot; in the log file:</p>
<div class="highlight-lua"><div class="highlight"><pre><span></span><span class="n">box</span><span class="p">.</span><span class="n">cfg</span><span class="p">{</span><span class="n">logger</span><span class="o">=</span><span class="s1">&#39;</span><span class="s">Log_file&#39;</span><span class="p">}</span>
<span class="n">log</span> <span class="o">=</span> <span class="nb">require</span><span class="p">(</span><span class="s1">&#39;</span><span class="s">log&#39;</span><span class="p">)</span>
<span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;</span><span class="s">Log Line #1&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>On Terminal #2: use <code class="docutils literal"><span class="pre">mv</span></code> so the log file is now named <cite>Log_file.bak</cite>.
The result of this is: the next log message will go to <cite>Log_file.bak</cite>. <br /></p>
<div class="highlight highlight-default"><div class="highlight"><pre><span></span><span class="n">mv</span> <span class="n">Log_file</span> <span class="n">Log_file</span><span class="o">.</span><span class="n">bak</span>
</pre></div>
</div>
<p>On Terminal #1: put a message &quot;Log Line #2&quot; in the log file. <br /></p>
<div class="highlight-lua"><div class="highlight"><pre><span></span><span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;</span><span class="s">Log Line #2&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>On Terminal #2: use <code class="docutils literal"><span class="pre">ps</span></code> to find the process ID of the Tarantool server. <br /></p>
<div class="highlight highlight-default"><div class="highlight"><pre><span></span><span class="n">ps</span> <span class="o">-</span><span class="n">A</span> <span class="o">|</span> <span class="n">grep</span> <span class="n">tarantool</span>
</pre></div>
</div>
<p>On Terminal #2: use <code class="docutils literal"><span class="pre">kill</span> <span class="pre">-HUP</span></code> to send a SIGHUP signal to the Tarantool server.
The result of this is: Tarantool will open <cite>Log_file</cite> again, and
the next log message will go to <cite>Log_file</cite>.
(The same effect could be accomplished by executing log.rotate() on the server.) <br /></p>
<pre class="highlight literal-block">
kill -HUP <em>process_id</em>
</pre>
<p>On Terminal #1: put a message &quot;Log Line #3&quot; in the log file.</p>
<div class="highlight-lua"><div class="highlight"><pre><span></span><span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;</span><span class="s">Log Line #3&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>On Terminal #2: use <code class="docutils literal"><span class="pre">less</span></code> to examine files. <cite>Log_file.bak</cite> will have these lines,
except that the date and time will depend on when the example is done:</p>
<div class="highlight highlight-default"><div class="highlight"><pre><span></span><span class="mi">2015</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">30</span> <span class="mi">15</span><span class="p">:</span><span class="mi">13</span><span class="p">:</span><span class="mf">06.373</span> <span class="p">[</span><span class="mi">27469</span><span class="p">]</span> <span class="n">main</span><span class="o">/</span><span class="mi">101</span><span class="o">/</span><span class="n">interactive</span> <span class="n">I</span><span class="o">&gt;</span> <span class="n">Log</span> <span class="n">Line</span> <span class="c1">#1`</span>
<span class="mi">2015</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">30</span> <span class="mi">15</span><span class="p">:</span><span class="mi">14</span><span class="p">:</span><span class="mf">25.973</span> <span class="p">[</span><span class="mi">27469</span><span class="p">]</span> <span class="n">main</span><span class="o">/</span><span class="mi">101</span><span class="o">/</span><span class="n">interactive</span> <span class="n">I</span><span class="o">&gt;</span> <span class="n">Log</span> <span class="n">Line</span> <span class="c1">#2`</span>
</pre></div>
</div>
<p>and <cite>Log_file</cite> will have</p>
<div class="highlight highlight-default"><div class="highlight"><pre><span></span><span class="n">log</span> <span class="n">file</span> <span class="n">has</span> <span class="n">been</span> <span class="n">reopened</span>
<span class="mi">2015</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">30</span> <span class="mi">15</span><span class="p">:</span><span class="mi">15</span><span class="p">:</span><span class="mf">32.629</span> <span class="p">[</span><span class="mi">27469</span><span class="p">]</span> <span class="n">main</span><span class="o">/</span><span class="mi">101</span><span class="o">/</span><span class="n">interactive</span> <span class="n">I</span><span class="o">&gt;</span> <span class="n">Log</span> <span class="n">Line</span> <span class="c1">#3</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="local-hot-standby">
<span id="book-cfg-local-hot-standby"></span><h2><a class="toc-backref" href="#id12">5.5. Local hot standby</a><a class="headerlink" href="#local-hot-standby" title="Permalink to this headline">¶</a></h2>
<p>Local hot standby is a feature which provides a simple form of failover without
replication. To initiate it, start a second instance of the Tarantool server on
the same computer with the same <a class="reference internal" href="../box/box_introspection.html#box-introspection-box-cfg"><span class="std std-ref">box.cfg</span></a> configuration settings -
including the same directories and same non-null URIs. A warning should appear with a
message like</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>W&gt; primary: [URI] is already in use, will retry binding after [n] seconds
</pre></div>
</div>
<p>This is fine. It means that the second instance is ready to take over if the
first instance goes down.</p>
<p>The expectation is that there will be two instances of the server using the
same configuration. The first one to start will be the &quot;primary&quot; instance.
The second one to start will be the &quot;standby&quot; instance. The standby instance
will initialize and will try to connect on listen address,
but will fail because the primary instance has already taken it. So the
standby instance goes into a loop, reading the write ahead log which the
primary instance is writing (so the two instances are always in synch),
and trying to connect on the port. If the primary instance goes down for any
reason, the port will become free so the standby instance will succeed in
connecting, and will become the primary instance. Thus there is no noticeable
downtime if the primary instance goes down.</p>
<p>If this local_hot_standby feature is being used, then wal_mode should
not be equal to &quot;none&quot;.</p>
</div>
</div>


  
    
      <div class="b-page_over-tail">
    
    
      <div class="b-page_over-prev">
        <a href="../replication/index.html"
           class="b-prev b-ellipsis"
           title="4. Replication">4. Replication</a>
      </div>
    
    <div class="b-page_over-lang">
      <ul class="b-page_over-lang-list">
        <li class="b-page_over-lang-item">
          <a href="../../_sources/book/configuration/index.txt"
             class="b-page_over-lang-url"> Source </a>
        </li>
      </ul>
    </div>
    
      <div class="b-page_over-next">
        <a href="../administration.html"
           class="b-next b-ellipsis"
           title="6. Server administration">6. Server administration</a>
      </div>
    
    </div>
  

  <div id="disqus_thread"></div>
  <script>
    /**
    *  RECOMMENDED CONFIGURATION VARIABLES:
    *  EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES
    *  FROM YOUR PLATFORM OR CMS.
    *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT:
    *  https://disqus.com/admin/universalcode/#configuration-variables
    */
    var disqus_config = function () {
        // Replace PAGE_URL with your page's canonical URL variable
        // this.page.url = PAGE_URL;
        // Replace PAGE_IDENTIFIER with your page's unique identifier variable
        this.page.identifier = "book/configuration/index";
        this.page.language = "en"
    };
    (function() {  // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');
        s.src = '//tarantooldb.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
  </script>
  <noscript>
    Please enable JavaScript to view the
    <a href="https://disqus.com/?ref_noscript" rel="nofollow">
      comments powered by Disqus.
    </a>
  </noscript>

        </div>
      </div>
    </div>
  
  <script>
  </script>

      </div>
    </div>

    <!-- FOOTER > -->
    <footer class="b-footer">
      <div class="b-footer-wrapper">
        <nav class="b-footer_menu">
          
  <ul class="b-menu">
    
      <li class="b-menu-item">
        
        <a href="http://tarantool.org" class="b-menu-item-url">Overview</a>
        
      </li>
    
      <li class="b-menu-item">
        
        <a href="http://try.tarantool.org" class="b-menu-item-url">Try</a>
        
      </li>
    
      <li class="b-menu-item">
        
        <a href="http://tarantool.org/doc/" class="b-menu-item-url p-active">Documentation</a>
        
      </li>
    
      <li class="b-menu-item">
        
        <a href="http://tarantool.org/download.html" class="b-menu-item-url">Download</a>
        
      </li>
    
      <li class="b-menu-item">
        
        <a href="http://tarantool.org/careers.html" class="b-menu-item-url">Careers</a>
        
      </li>
    
      <li class="b-menu-item">
        
        <a href="http://rocks.tarantool.org" class="b-menu-item-url">Rocks</a>
        
      </li>
    
  </ul>

          <div class="b-footer-other">
            <a href="http://stable.tarantool.org">1.5 web site and downloads</a>
          </div>
        </nav>
      </div>
    </footer>
  <!-- < FOOTER -->
  </body>
</html>

